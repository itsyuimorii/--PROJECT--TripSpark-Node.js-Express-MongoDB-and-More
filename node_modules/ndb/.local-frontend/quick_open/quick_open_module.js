self["QuickOpen"]=self["QuickOpen"]||{};QuickOpen.FilteredListWidget=class extends UI.VBox{constructor(e,t,i){super(true);this._promptHistory=t||[];this.contentElement.classList.add("filtered-list-widget");this.contentElement.addEventListener("keydown",this._onKeyDown.bind(this),true);this.registerRequiredCSS("quick_open/filteredListWidget.css");this._promptElement=this.contentElement.createChild("div","filtered-list-widget-input");this._promptElement.setAttribute("spellcheck","false");this._promptElement.setAttribute("contenteditable","plaintext-only");this._prompt=new UI.TextPrompt;this._prompt.initialize(()=>Promise.resolve([]));const s=this._prompt.attach(this._promptElement);s.addEventListener("input",this._onInput.bind(this),false);s.classList.add("filtered-list-widget-prompt-element");this._bottomElementsContainer=this.contentElement.createChild("div","vbox");this._progressElement=this._bottomElementsContainer.createChild("div","filtered-list-widget-progress");this._progressBarElement=this._progressElement.createChild("div","filtered-list-widget-progress-bar");this._items=new UI.ListModel;this._list=new UI.ListControl(this._items,this,UI.ListMode.EqualHeightItems);this._itemElementsContainer=this._list.element;this._itemElementsContainer.classList.add("container");this._bottomElementsContainer.appendChild(this._itemElementsContainer);this._itemElementsContainer.addEventListener("click",this._onClick.bind(this),false);this._notFoundElement=this._bottomElementsContainer.createChild("div","not-found-text");this._notFoundElement.classList.add("hidden");this.setDefaultFocusedElement(this._promptElement);this._prefix="";this._provider=e;this._queryChangedCallback=i}static highlightRanges(e,t,i){if(!t)return false;function s(e,t){const i=Diff.Diff.charDiff(t,e);let s=0;const r=[];for(let e=0;e<i.length;++e){const t=i[e];if(t[0]===Diff.Diff.Operation.Equal)r.push(new TextUtils.SourceRange(s,t[1].length));else if(t[0]!==Diff.Diff.Operation.Insert)return null;s+=t[1].length}return r}const r=e.textContent;let n=s(r,t);if(!n||i)n=s(r.toUpperCase(),t.toUpperCase());if(n){UI.highlightRangesWithStyleClass(e,n,"highlight");return true}return false}setPlaceholder(e){this._prompt.setPlaceholder(e)}showAsDialog(){this._dialog=new UI.Dialog;this._dialog.setMaxContentSize(new UI.Size(504,340));this._dialog.setSizeBehavior(UI.GlassPane.SizeBehavior.SetExactWidthMaxHeight);this._dialog.setContentPosition(null,22);this.show(this._dialog.contentElement);this._dialog.show()}setPrefix(e){this._prefix=e}setProvider(e){if(e===this._provider)return;if(this._provider)this._provider.detach();this._clearTimers();this._provider=e;if(this.isShowing())this._attachProvider()}_attachProvider(){this._items.replaceAll([]);this._list.invalidateItemHeight();if(this._provider){this._provider.setRefreshCallback(this._itemsLoaded.bind(this,this._provider));this._provider.attach()}this._itemsLoaded(this._provider)}_value(){return this._prompt.text().trim()}_cleanValue(){return this._value().substring(this._prefix.length)}wasShown(){this._attachProvider()}willHide(){if(this._provider)this._provider.detach();this._clearTimers()}_clearTimers(){clearTimeout(this._filterTimer);clearTimeout(this._scoringTimer);clearTimeout(this._loadTimeout);delete this._filterTimer;delete this._scoringTimer;delete this._loadTimeout;delete this._refreshListWithCurrentResult}_onEnter(e){if(!this._provider)return;const t=this._provider.itemCount()?this._list.selectedItem():null;this._selectItem(t);if(this._dialog)this._dialog.hide()}_itemsLoaded(e){if(this._loadTimeout||e!==this._provider)return;this._loadTimeout=setTimeout(this._updateAfterItemsLoaded.bind(this),0)}_updateAfterItemsLoaded(){delete this._loadTimeout;this._filterItems()}createElementForItem(e){const t=createElement("div");t.className="filtered-list-widget-item "+(this._provider.renderAsTwoRows()?"two-rows":"one-row");const i=t.createChild("div","filtered-list-widget-title");const s=t.createChild("div","filtered-list-widget-subtitle");s.textContent="â€‹";this._provider.renderItem(e,this._cleanValue(),i,s);return t}heightForItem(e){return 0}isItemSelectable(e){return true}selectedItemChanged(e,t,i,s){if(i)i.classList.remove("selected");if(s){s.classList.add("selected");UI.ARIAUtils.alert(s.textContent,s)}}_onClick(e){const t=this._list.itemForNode(e.target);if(t===null)return;e.consume(true);this._selectItem(t);if(this._dialog)this._dialog.hide()}setQuery(e){this._prompt.focus();this._prompt.setText(e);this._queryChanged();this._prompt.autoCompleteSoon(true);this._scheduleFilter()}_tabKeyPressed(){const e=this._prompt.text();let t;for(let i=this._promptHistory.length-1;i>=0;i--){if(this._promptHistory[i]!==e&&this._promptHistory[i].startsWith(e)){t=this._promptHistory[i];break}}if(!t)return false;this._prompt.focus();this._prompt.setText(t);this._prompt.setDOMSelection(e.length,t.length);this._scheduleFilter();return true}_itemsFilteredForTest(){}_filterItems(){delete this._filterTimer;if(this._scoringTimer){clearTimeout(this._scoringTimer);delete this._scoringTimer;if(this._refreshListWithCurrentResult)this._refreshListWithCurrentResult()}if(!this._provider){this._bottomElementsContainer.classList.toggle("hidden",true);this._itemsFilteredForTest();return}this._bottomElementsContainer.classList.toggle("hidden",false);this._progressBarElement.style.transform="scaleX(0)";this._progressBarElement.classList.remove("filtered-widget-progress-fade");this._progressBarElement.classList.remove("hidden");const e=this._provider.rewriteQuery(this._cleanValue());this._query=e;const t=e?String.filterRegex(e):null;const i=[];const s=[];const r=[];const n=100;let o=0;const l=[];const d=window.performance.now();const a=Number.constrain(10,500,this._provider.itemCount()/10|0);c.call(this,0);function h(e,t){return t-e}function c(m){delete this._scoringTimer;let u=0;let p;for(p=m;p<this._provider.itemCount()&&u<a;++p){if(t&&!t.test(this._provider.itemKeyAt(p)))continue;const d=this._provider.itemScoreAt(p,e);if(e)u++;if(d>o||s.length<n){const e=s.upperBound(d,h);s.splice(e,0,d);r.splice(e,0,p);if(s.length>n){l.push(r.peekLast());s.length=n;r.length=n}o=s.peekLast()}else{i.push(p)}}this._refreshListWithCurrentResult=this._refreshList.bind(this,r,l,i);if(p<this._provider.itemCount()){this._scoringTimer=setTimeout(c.bind(this,p),0);if(window.performance.now()-d>50)this._progressBarElement.style.transform="scaleX("+p/this._provider.itemCount()+")";return}if(window.performance.now()-d>100){this._progressBarElement.style.transform="scaleX(1)";this._progressBarElement.classList.add("filtered-widget-progress-fade")}else{this._progressBarElement.classList.add("hidden")}this._refreshListWithCurrentResult()}}_refreshList(e,t,i){delete this._refreshListWithCurrentResult;i=[].concat(e,t,i);this._updateNotFoundMessage(!!i.length);const s=this._list.element.offsetHeight;this._items.replaceAll(i);if(i.length)this._list.selectItem(i[0]);if(this._list.element.offsetHeight!==s)this._list.viewportResized();this._itemsFilteredForTest()}_updateNotFoundMessage(e){this._list.element.classList.toggle("hidden",!e);this._notFoundElement.classList.toggle("hidden",e);if(!e)this._notFoundElement.textContent=this._provider.notFoundText(this._cleanValue())}_onInput(){this._queryChanged();this._scheduleFilter()}_queryChanged(){if(this._queryChangedCallback)this._queryChangedCallback(this._value());if(this._provider)this._provider.queryChanged(this._cleanValue())}_onKeyDown(e){let t=false;switch(e.key){case"Enter":this._onEnter(e);return;case"Tab":t=this._tabKeyPressed();break;case"ArrowUp":t=this._list.selectPreviousItem(true,false);break;case"ArrowDown":t=this._list.selectNextItem(true,false);break;case"PageUp":t=this._list.selectItemPreviousPage(false);break;case"PageDown":t=this._list.selectItemNextPage(false);break}if(t)e.consume(true)}_scheduleFilter(){if(this._filterTimer)return;this._filterTimer=setTimeout(this._filterItems.bind(this),0)}_selectItem(e){this._promptHistory.push(this._value());if(this._promptHistory.length>100)this._promptHistory.shift();this._provider.selectItem(e,this._cleanValue())}};QuickOpen.FilteredListWidget.Provider=class{setRefreshCallback(e){this._refreshCallback=e}attach(){}itemCount(){return 0}itemKeyAt(e){return""}itemScoreAt(e,t){return 1}renderItem(e,t,i,s){}renderAsTwoRows(){return false}selectItem(e,t){}refresh(){this._refreshCallback()}rewriteQuery(e){return e}queryChanged(e){}notFoundText(e){return Common.UIString("No results found")}detach(){}};QuickOpen.QuickOpen=class{constructor(){this._prefix=null;this._query="";this._providers=new Map;this._prefixes=[];this._filteredListWidget=null;self.runtime.extensions(QuickOpen.FilteredListWidget.Provider).forEach(this._addProvider.bind(this));this._prefixes.sort((e,t)=>t.length-e.length)}static show(e){const t=new this;const i=new QuickOpen.FilteredListWidget(null,this._history,t._queryChanged.bind(t));t._filteredListWidget=i;i.setPlaceholder(Common.UIString("Type '?' to see available commands"));i.showAsDialog();i.setQuery(e)}_addProvider(e){const t=e.descriptor()["prefix"];this._prefixes.push(t);this._providers.set(t,e.instance.bind(e))}_queryChanged(e){const t=this._prefixes.find(t=>e.startsWith(t));if(typeof t!=="string"||this._prefix===t)return;this._prefix=t;this._filteredListWidget.setPrefix(t);this._filteredListWidget.setProvider(null);this._providers.get(t)().then(e=>{if(this._prefix!==t)return;this._filteredListWidget.setProvider(e);this._providerLoadedForTest(e)})}_providerLoadedForTest(e){}};QuickOpen.QuickOpen._history=[];QuickOpen.QuickOpen.ShowActionDelegate=class{handleAction(e,t){switch(t){case"quickOpen.show":QuickOpen.QuickOpen.show("");return true}return false}};QuickOpen.CommandMenu=class{constructor(){this._commands=[];this._loadCommands()}static createCommand(e,t,i,s,r,n){const o=t.replace(/,/g,"\0");return new QuickOpen.CommandMenu.Command(e,i,o,s,r,n)}static createSettingCommand(e,t,i){const s=e.descriptor()["category"]||"";const r=e.descriptor()["tags"]||"";const n=Common.settings.moduleSetting(e.descriptor()["settingName"]);return QuickOpen.CommandMenu.createCommand(s,r,t,"",n.set.bind(n,i),o);function o(){return n.get()!==i}}static createActionCommand(e){const t=UI.shortcutRegistry.shortcutTitleForAction(e.id())||"";return QuickOpen.CommandMenu.createCommand(e.category(),e.tags(),e.title(),t,e.execute.bind(e))}static createRevealViewCommand(e,t){const i=e.descriptor()["id"];const s=UI.viewManager.showView.bind(UI.viewManager,i);const r=e.descriptor()["tags"]||"";return QuickOpen.CommandMenu.createCommand(t,r,Common.UIString("Show %s",e.title()),"",s)}_loadCommands(){const e=new Map;self.runtime.extensions(UI.ViewLocationResolver).forEach(t=>{const i=t.descriptor()["category"];const s=t.descriptor()["name"];if(i&&s)e.set(s,i)});const t=self.runtime.extensions("view");for(const i of t){const t=e.get(i.descriptor()["location"]);if(t)this._commands.push(QuickOpen.CommandMenu.createRevealViewCommand(i,t))}const i=self.runtime.extensions("setting");for(const e of i){const t=e.descriptor()["options"];if(!t||!e.descriptor()["category"])continue;for(const i of t)this._commands.push(QuickOpen.CommandMenu.createSettingCommand(e,i["title"],i["value"]))}}commands(){return this._commands}};QuickOpen.CommandMenuProvider=class extends QuickOpen.FilteredListWidget.Provider{constructor(){super();this._commands=[]}attach(){const e=QuickOpen.commandMenu.commands();const t=UI.actionRegistry.availableActions();for(const e of t){if(e.category())this._commands.push(QuickOpen.CommandMenu.createActionCommand(e))}for(const t of e){if(t.available())this._commands.push(t)}this._commands=this._commands.sort(i);function i(e,t){const i=e.category().compareTo(t.category());return i?i:e.title().compareTo(t.title())}}detach(){this._commands=[]}itemCount(){return this._commands.length}itemKeyAt(e){return this._commands[e].key()}itemScoreAt(e,t){const i=this._commands[e];const s=Diff.Diff.charDiff(t.toLowerCase(),i.title().toLowerCase());let r=0;for(let e=0;e<s.length;++e){if(s[e][0]===Diff.Diff.Operation.Equal)r+=s[e][1].length*s[e][1].length}if(i.category().startsWith("Panel"))r+=2;else if(i.category().startsWith("Drawer"))r+=1;return r}renderItem(e,t,i,s){const r=this._commands[e];i.removeChildren();const n=i.createChild("span","tag");const o=String.hashCode(r.category())%QuickOpen.CommandMenuProvider.MaterialPaletteColors.length;n.style.backgroundColor=QuickOpen.CommandMenuProvider.MaterialPaletteColors[o];n.textContent=r.category();i.createTextChild(r.title());QuickOpen.FilteredListWidget.highlightRanges(i,t,true);s.textContent=r.shortcut()}selectItem(e,t){if(e===null)return;this._commands[e].execute();Host.userMetrics.actionTaken(Host.UserMetrics.Action.SelectCommandFromCommandMenu)}notFoundText(){return Common.UIString("No commands found")}};QuickOpen.CommandMenuProvider.MaterialPaletteColors=["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFC107","#FF9800","#FF5722","#795548","#9E9E9E","#607D8B"];QuickOpen.CommandMenu.Command=class{constructor(e,t,i,s,r,n){this._category=e;this._title=t;this._key=e+"\0"+t+"\0"+i;this._shortcut=s;this._executeHandler=r;this._availableHandler=n}category(){return this._category}title(){return this._title}key(){return this._key}shortcut(){return this._shortcut}available(){return this._availableHandler?this._availableHandler():true}execute(){this._executeHandler()}};QuickOpen.commandMenu=new QuickOpen.CommandMenu;QuickOpen.CommandMenu.ShowActionDelegate=class{handleAction(e,t){InspectorFrontendHost.bringToFront();QuickOpen.QuickOpen.show(">");return true}};QuickOpen.HelpQuickOpen=class extends QuickOpen.FilteredListWidget.Provider{constructor(){super();this._providers=[];self.runtime.extensions(QuickOpen.FilteredListWidget.Provider).forEach(this._addProvider.bind(this))}_addProvider(e){if(e.descriptor()["title"])this._providers.push({prefix:e.descriptor()["prefix"],title:e.descriptor()["title"]})}itemCount(){return this._providers.length}itemKeyAt(e){return this._providers[e].prefix}itemScoreAt(e,t){return-this._providers[e].prefix.length}renderItem(e,t,i,s){const r=this._providers[e];const n=i.createChild("span","monospace");n.textContent=(r.prefix||"â€¦")+" ";i.createTextChild(r.title)}selectItem(e,t){if(e!==null)QuickOpen.QuickOpen.show(this._providers[e].prefix)}renderAsTwoRows(){return false}};Runtime.cachedResources["quick_open/filteredListWidget.css"]="/*\n * Copyright (c) 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.filtered-list-widget {\n    display: flex;\n    flex-direction: column;\n    flex: auto;\n}\n\n.filtered-list-widget-prompt-element {\n    flex: 0 0 34px;\n    border: 0;\n    margin: 0;\n    padding: 0 6px;\n    z-index: 1;\n    font-size: inherit;\n}\n\n.filtered-list-widget-input {\n    white-space: pre;\n    height: 18px;\n    margin-top: 12px;\n    overflow: hidden;\n    flex: auto;\n}\n\n.filtered-list-widget-progress {\n    flex: none;\n    background: rgba(0, 0, 0, 0.2);\n    height: 2px;\n}\n\n.filtered-list-widget-progress-bar {\n    background-color: #2196F3;\n    height: 2px;\n    width: 100%;\n    transform: scaleX(0);\n    transform-origin: top left;\n    opacity: 1;\n    transition: none;\n}\n\n.filtered-widget-progress-fade {\n    opacity: 0;\n    transition: opacity 500ms;\n}\n\n.filtered-list-widget > div.container {\n    flex: auto;\n    overflow-y: auto;\n    background: #fbfbfb;\n}\n\n.filtered-list-widget-item {\n    padding: 4px 6px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    color: rgb(95, 95, 95);\n}\n\n.filtered-list-widget-item.selected {\n    background-color: #f0f0f0;\n}\n\n:host-context(.-theme-with-dark-background) .filtered-list-widget-item.selected {\n    background-color: #333333;\n}\n\n.filtered-list-widget-item span.highlight {\n    color: #222;\n    font-weight: bold;\n}\n\n.filtered-list-widget-item .filtered-list-widget-title {\n    flex: auto;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.filtered-list-widget-item .filtered-list-widget-subtitle {\n    flex: none;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    color: rgb(155, 155, 155);\n    display: flex;\n}\n\n.filtered-list-widget-item .filtered-list-widget-subtitle .first-part {\n    flex-shrink: 1000;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.filtered-list-widget-item.one-row {\n    display: flex;\n}\n\n.filtered-list-widget-item.two-rows {\n    border-bottom: 1px solid rgb(235, 235, 235);\n}\n\n.tag {\n    color: white;\n    padding: 1px 3px;\n    margin-right: 5px;\n    border-radius: 2px;\n    line-height: 18px;\n}\n\n.filtered-list-widget-item .tag .highlight {\n    color: white;\n}\n\n.not-found-text {\n    height: 34px;\n    line-height: 34px;\n    padding-left: 4px;\n    font-style: italic;\n    color: #888;\n    background: #fbfbfb;\n}\n";