self["ObjectUI"]=self["ObjectUI"]||{};ObjectUI.CustomPreviewSection=class{constructor(e){this._sectionElement=createElementWithClass("span","custom-expandable-section");this._object=e;this._expanded=false;this._cachedContent=null;const t=e.customPreview();let n;try{n=JSON.parse(t.header)}catch(e){Common.console.error("Broken formatter: header is invalid json "+e);return}this._header=this._renderJSONMLTag(n);if(this._header.nodeType===Node.TEXT_NODE){Common.console.error("Broken formatter: header should be an element node.");return}if(t.hasBody||t.bodyGetterId){this._header.classList.add("custom-expandable-section-header");this._header.addEventListener("click",this._onClick.bind(this),false);this._expandIcon=UI.Icon.create("smallicon-triangle-right","custom-expand-icon");this._header.insertBefore(this._expandIcon,this._header.firstChild)}this._sectionElement.appendChild(this._header)}element(){return this._sectionElement}_renderJSONMLTag(e){if(!Array.isArray(e))return createTextNode(e+"");const t=e;return t[0]==="object"?this._layoutObjectTag(t):this._renderElement(t)}_renderElement(e){const t=e.shift();if(!ObjectUI.CustomPreviewSection._tagsWhiteList.has(t)){Common.console.error("Broken formatter: element "+t+" is not allowed!");return createElement("span")}const n=createElement(t);if(typeof e[0]==="object"&&!Array.isArray(e[0])){const t=e.shift();for(const e in t){const i=t[e];if(e!=="style"||typeof i!=="string")continue;n.setAttribute(e,i)}}this._appendJsonMLTags(n,e);return n}_layoutObjectTag(e){e.shift();const t=e.shift();const n=this._object.runtimeModel().createRemoteObject(t);if(n.customPreview())return new ObjectUI.CustomPreviewSection(n).element();const i=ObjectUI.ObjectPropertiesSection.defaultObjectPresentation(n);i.classList.toggle("custom-expandable-section-standard-section",n.hasChildren);return i}_appendJsonMLTags(e,t){for(let n=0;n<t.length;++n)e.appendChild(this._renderJSONMLTag(t[n]))}_onClick(e){e.consume(true);if(this._cachedContent)this._toggleExpand();else this._loadBody()}_toggleExpand(){this._expanded=!this._expanded;this._header.classList.toggle("expanded",this._expanded);this._cachedContent.classList.toggle("hidden",!this._expanded);if(this._expanded)this._expandIcon.setIconType("smallicon-triangle-down");else this._expandIcon.setIconType("smallicon-triangle-right")}_loadBody(){function e(e,t,n){function i(t){if(!t||typeof t!=="object"||typeof t.splice!=="function")return;const n=t.length;if(!(typeof n==="number"&&n>>>0===n&&(n>0||1/n>0)))return;let r=1;if(t[0]==="object"){const n=t[1];const i=n["object"];const o=n["config"];if(typeof i==="undefined")throw'Illegal format: obligatory attribute "object" isn\'t specified';t[1]=e(i,o);r=2}for(let e=r;e<t.length;++e)i(t[e])}try{const e=t.body(this,n);i(e);return e}catch(e){console.error("Custom Formatter Failed: "+e);return null}}const t=this._object.customPreview();if(t.bindRemoteObjectFunctionId&&t.formatterObjectId){const i=[{objectId:t.bindRemoteObjectFunctionId},{objectId:t.formatterObjectId}];if(t.configObjectId)i.push({objectId:t.configObjectId});this._object.callFunctionJSON(e,i).then(n.bind(this))}else if(t.bodyGetterId){this._object.callFunctionJSON(e=>e(),[{objectId:t.bodyGetterId}]).then(n.bind(this))}function n(e){if(!e)return;this._cachedContent=this._renderJSONMLTag(e);this._sectionElement.appendChild(this._cachedContent);this._toggleExpand()}}};ObjectUI.CustomPreviewComponent=class{constructor(e){this._object=e;this._customPreviewSection=new ObjectUI.CustomPreviewSection(e);this.element=createElementWithClass("span","source-code");const t=UI.createShadowRootWithCoreStyles(this.element,"object_ui/customPreviewComponent.css");this.element.addEventListener("contextmenu",this._contextMenuEventFired.bind(this),false);t.appendChild(this._customPreviewSection.element())}expandIfPossible(){if((this._object.customPreview().hasBody||this._object.customPreview().bodyGetterId)&&this._customPreviewSection)this._customPreviewSection._loadBody()}_contextMenuEventFired(e){const t=new UI.ContextMenu(e);if(this._customPreviewSection){t.revealSection().appendItem(Common.UIString("Show as JavaScript object"),this._disassemble.bind(this))}t.appendApplicableItems(this._object);t.show()}_disassemble(){this.element.shadowRoot.textContent="";this._customPreviewSection=null;this.element.shadowRoot.appendChild(ObjectUI.ObjectPropertiesSection.defaultObjectPresentation(this._object))}};ObjectUI.CustomPreviewSection._tagsWhiteList=new Set(["span","div","ol","li","table","tr","td"]);ObjectUI.ObjectPopoverHelper=class{constructor(e,t){this._linkifier=e;this._resultHighlightedAsDOM=t}dispose(){if(this._resultHighlightedAsDOM)SDK.OverlayModel.hideDOMNodeHighlight();if(this._linkifier)this._linkifier.dispose()}static async buildObjectPopover(e,t){const n=e.description.trimEnd(ObjectUI.ObjectPopoverHelper.MaxPopoverTextLength);let i=null;if(e.type==="object"){let r=null;let o=false;if(e.subtype==="node"){SDK.OverlayModel.highlightObjectAsDOMNode(e);o=true}if(e.customPreview()){const t=new ObjectUI.CustomPreviewComponent(e);t.expandIfPossible();i=t.element}else{i=createElementWithClass("div","object-popover-content");UI.appendStyle(i,"object_ui/objectPopover.css");const t=i.createChild("div","monospace object-popover-title");t.createChild("span").textContent=n;r=new Components.Linkifier;const o=new ObjectUI.ObjectPropertiesSection(e,"",r,undefined,undefined,undefined,true);o.element.classList.add("object-popover-tree");o.titleLessMode();i.appendChild(o.element)}t.setMaxContentSize(new UI.Size(300,250));t.setSizeBehavior(UI.GlassPane.SizeBehavior.SetExactSize);t.contentElement.appendChild(i);return new ObjectUI.ObjectPopoverHelper(r,o)}i=createElement("span");UI.appendStyle(i,"object_ui/objectValue.css");UI.appendStyle(i,"object_ui/objectPopover.css");const r=i.createChild("span","monospace object-value-"+e.type);r.style.whiteSpace="pre";if(e.type==="string")r.createTextChildren(`"${n}"`);else if(e.type!=="function")r.textContent=n;if(e.type!=="function"){t.contentElement.appendChild(i);return new ObjectUI.ObjectPopoverHelper(null,false)}ObjectUI.ObjectPropertiesSection.formatObjectAsFunction(e,r,true);const o=await e.debuggerModel().functionDetailsPromise(e);if(!o)return null;const s=createElementWithClass("div","object-popover-container");const a=s.createChild("div","function-popover-title source-code");const c=a.createChild("span","function-name");c.textContent=UI.beautifyFunctionName(o.functionName);const l=o.location;const p=a.createChild("div","function-title-link-container");const u=l&&l.script()&&l.script().sourceURL;let d=null;if(u){d=new Components.Linkifier;p.appendChild(d.linkifyRawLocation(l,u))}s.appendChild(i);t.contentElement.appendChild(s);return new ObjectUI.ObjectPopoverHelper(d,false)}};ObjectUI.ObjectPopoverHelper.MaxPopoverTextLength=1e4;ObjectUI.ObjectPropertiesSection=class extends UI.TreeOutlineInShadow{constructor(e,t,n,i,r,o,s){super();this._object=e;this._editable=true;if(!s)this.hideOverflow();this.setFocusable(true);this.setShowSelectionOnKeyboardFocus(true);this._objectTreeElement=new ObjectUI.ObjectPropertiesSection.RootElement(e,n,i,r,o);this.appendChild(this._objectTreeElement);if(typeof t==="string"||!t){this.titleElement=this.element.createChild("span");this.titleElement.textContent=t||""}else{this.titleElement=t;this.element.appendChild(t)}if(!this.titleElement.hasAttribute("tabIndex"))this.titleElement.tabIndex=-1;this.element._section=this;this.registerRequiredCSS("object_ui/objectValue.css");this.registerRequiredCSS("object_ui/objectPropertiesSection.css");this.rootElement().childrenListElement.classList.add("source-code","object-properties-section")}static defaultObjectPresentation(e,t,n,i){const r=createElementWithClass("span","source-code");const o=UI.createShadowRootWithCoreStyles(r,"object_ui/objectValue.css");o.appendChild(ObjectUI.ObjectPropertiesSection.createValueElement(e,false,true));if(!e.hasChildren)return r;const s=new ObjectUI.ObjectPropertiesSection(e,r,t);s.editable=false;if(n)s.skipProto();if(i)s.setEditable(false);return s.element}static CompareProperties(e,t){const n=e.name;const i=t.name;if(n==="__proto__")return 1;if(i==="__proto__")return-1;if(!e.enumerable&&t.enumerable)return 1;if(!t.enumerable&&e.enumerable)return-1;if(n.startsWith("_")&&!i.startsWith("_"))return 1;if(i.startsWith("_")&&!n.startsWith("_"))return-1;if(e.symbol&&!t.symbol)return 1;if(t.symbol&&!e.symbol)return-1;if(e.private&&!t.private)return 1;if(t.private&&!e.private)return-1;return String.naturalOrderComparator(n,i)}static createNameElement(e,t){if(e===null)return UI.html`<span class="name"></span>`;if(/^\s|\s$|^$|\n/.test(e))return UI.html`<span class="name">"${e.replace(/\n/g,"↵")}"</span>`;if(t){return UI.html`<span class="name">
        <span class="private-property-hash">${e[0]}</span>${e.substring(1)}
      </span>`}return UI.html`<span class="name">${e}</span>`}static valueElementForFunctionDescription(e,t,n){const i=createElementWithClass("span","object-value-function");e=e||"";const r=e.replace(/^function [gs]et /,"function ").replace(/^function [gs]et\(/,"function(").replace(/^[gs]et /,"");n=n||"";const o=r.match(/^(async\s+function)/);const s=r.startsWith("function*");const a=r.startsWith("*");const c=!s&&r.startsWith("function");const l=r.startsWith("class ")||r.startsWith("class{");const p=r.indexOf("=>");const u=!o&&!s&&!c&&!l&&p>0;let d;if(l){d=r.substring("class".length);const e=/^[^{\s]+/.exec(d.trim());let t=n;if(e)t=e[0].trim()||n;m("class",d,t)}else if(o){d=r.substring(o[1].length);m("async ƒ",d,h(d))}else if(s){d=r.substring("function*".length);m("ƒ*",d,h(d))}else if(a){d=r.substring("*".length);m("ƒ*",d,h(d))}else if(c){d=r.substring("function".length);m("ƒ",d,h(d))}else if(u){const e=60;let t=r;if(n)t=n+"()";else if(r.length>e)t=r.substring(0,p+2)+" {…}";m("",r,t)}else{m("ƒ",r,h(r))}i.title=e.trimEnd(500);return i;function h(e){const t=e.indexOf("(");const i=e.match(/\)\s*{/);if(t!==-1&&i&&i.index>t){const r=e.substring(0,t).trim()||n;const o=e.substring(t,i.index+1);return r+o}return n+"()"}function m(e,n,r){const o=200;if(e.length)i.createChild("span","object-value-function-prefix").textContent=e+" ";if(t)i.createTextChild(n.trim().trimEnd(o));else i.createTextChild(r.replace(/\n/g," "))}}static createValueElementWithCustomSupport(e,t,n,i,r){if(e.customPreview()){const t=new ObjectUI.CustomPreviewComponent(e).element;t.classList.add("object-properties-section-custom-section");return t}return ObjectUI.ObjectPropertiesSection.createValueElement(e,t,n,i,r)}static createValueElement(e,t,n,i,r){let o;const s=e.type;const a=e.subtype;const c=e.description;if(s==="object"&&a==="internal#location"){const t=e.debuggerModel().createRawLocationByScriptId(e.value.scriptId,e.value.lineNumber,e.value.columnNumber);if(t&&r)return r.linkifyRawLocation(t,"");o=l()}else if(s==="string"&&typeof c==="string"){o=p()}else if(s==="function"){o=ObjectUI.ObjectPropertiesSection.valueElementForFunctionDescription(c)}else if(s==="object"&&a==="node"&&c){o=u()}else if(s==="number"&&c&&c.indexOf("e")!==-1){o=d();if(i)i.classList.add("hbox")}else{o=createElementWithClass("span","object-value-"+(a||s));o.title=c||"";if(e.preview&&n){const t=new ObjectUI.RemoteObjectPreviewFormatter;t.appendObjectPreview(o,e.preview,false)}else if(c.length>ObjectUI.ObjectPropertiesSection._maxRenderableStringLength){o.appendChild(UI.createExpandableText(c,50))}else{o.textContent=c}}if(t){const e=createElementWithClass("span","error value");e.appendChild(UI.formatLocalized("[Exception: %s]",[o]));return e}o.classList.add("value");return o;function l(){const e=createElementWithClass("span");e.textContent="<"+Common.UIString("unknown")+">";e.title=c||"";return e}function p(){const e=createElementWithClass("span","object-value-string");const t=c.replace(/\n/g,"↵");e.createChild("span","object-value-string-quote").textContent='"';if(c.length>ObjectUI.ObjectPropertiesSection._maxRenderableStringLength)e.appendChild(UI.createExpandableText(t,50));else e.createTextChild(t);e.createChild("span","object-value-string-quote").textContent='"';e.title=c||"";return e}function u(){const t=createElementWithClass("span","object-value-node");ObjectUI.RemoteObjectPreviewFormatter.createSpansForNodeTitle(t,c);t.addEventListener("click",t=>{Common.Revealer.reveal(e);t.consume(true)},false);t.addEventListener("mousemove",()=>SDK.OverlayModel.highlightObjectAsDOMNode(e),false);t.addEventListener("mouseleave",()=>SDK.OverlayModel.hideDOMNodeHighlight(),false);return t}function d(){const e=createElementWithClass("span","object-value-number");const t=c.split("e");e.createChild("span","object-value-scientific-notation-mantissa").textContent=t[0];e.createChild("span","object-value-scientific-notation-exponent").textContent="e"+t[1];e.classList.add("object-value-scientific-notation-number");e.title=c||"";return e}}static formatObjectAsFunction(e,t,n,i){return e.debuggerModel().functionDetailsPromise(e).then(r);function r(r){if(n&&r&&r.location){t.classList.add("linkified");t.addEventListener("click",()=>Common.Revealer.reveal(r.location)&&false)}let o=i?"":"anonymous";if(r&&r.functionName)o=r.functionName;const s=ObjectUI.ObjectPropertiesSection.valueElementForFunctionDescription(e.description,i,o);t.appendChild(s)}}static _isDisplayableProperty(e,t){if(!t||!t.synthetic)return true;const n=e.name;const i=t.name==="[[Entries]]"&&(n==="length"||n==="__proto__");return!i}skipProto(){this._skipProto=true}expand(){this._objectTreeElement.expand()}setEditable(e){this._editable=e}objectTreeElement(){return this._objectTreeElement}enableContextMenu(){this.element.addEventListener("contextmenu",this._contextMenuEventFired.bind(this),false)}_contextMenuEventFired(e){const t=new UI.ContextMenu(e);t.appendApplicableItems(this._object);if(this._object instanceof SDK.LocalJSONObject){t.viewSection().appendItem(ls`Expand recursively`,this._objectTreeElement.expandRecursively.bind(this._objectTreeElement,Number.MAX_VALUE));t.viewSection().appendItem(ls`Collapse children`,this._objectTreeElement.collapseChildren.bind(this._objectTreeElement))}t.show()}titleLessMode(){this._objectTreeElement.listItemElement.classList.add("hidden");this._objectTreeElement.childrenListElement.classList.add("title-less-mode");this._objectTreeElement.expand()}};ObjectUI.ObjectPropertiesSection._arrayLoadThreshold=100;ObjectUI.ObjectPropertiesSection._maxRenderableStringLength=1e4;ObjectUI.ObjectPropertiesSection.RootElement=class extends UI.TreeElement{constructor(e,t,n,i,r){const o=createElement("slot");super(o);this._object=e;this._extraProperties=r||[];this._ignoreHasOwnProperty=!!i;this._emptyPlaceholder=n;this.setExpandable(true);this.selectable=true;this.toggleOnClick=true;this.listItemElement.classList.add("object-properties-section-root-element");this._linkifier=t}onexpand(){if(this.treeOutline)this.treeOutline.element.classList.add("expanded")}oncollapse(){if(this.treeOutline)this.treeOutline.element.classList.remove("expanded")}ondblclick(e){return true}async onpopulate(){return ObjectUI.ObjectPropertyTreeElement._populate(this,this._object,!!this.treeOutline._skipProto,this._linkifier,this._emptyPlaceholder,this._ignoreHasOwnProperty,this._extraProperties)}};ObjectUI.ObjectPropertyTreeElement=class extends UI.TreeElement{constructor(e,t){super();this.property=e;this.toggleOnClick=true;this._highlightChanges=[];this._linkifier=t;this.listItemElement.addEventListener("contextmenu",this._contextMenuFired.bind(this),false)}static async _populate(e,t,n,i,r,o,s,a){if(t.arrayLength()>ObjectUI.ObjectPropertiesSection._arrayLoadThreshold){e.removeChildren();ObjectUI.ArrayGroupingTreeElement._populateArray(e,t,0,t.arrayLength()-1,i);return}let c;if(o)c=await t.getAllProperties(false,true);else c=await SDK.RemoteObject.loadFromObjectPerProto(t,true);const l=c.properties;const p=c.internalProperties;e.removeChildren();if(!l)return;s=s||[];for(let e=0;e<s.length;++e)l.push(s[e]);ObjectUI.ObjectPropertyTreeElement.populateWithProperties(e,l,p,n,a||t,i,r)}static populateWithProperties(e,t,n,i,r,o,s){t.sort(ObjectUI.ObjectPropertiesSection.CompareProperties);n=n||[];const a=n.find(e=>e.name==="[[Entries]]");if(a){a.parentObject=r;const t=new ObjectUI.ObjectPropertyTreeElement(a,o);t.setExpandable(true);t.expand();e.appendChild(t)}const c=[];let l=null;for(let n=0;n<t.length;++n){const i=t[n];i.parentObject=r;if(!ObjectUI.ObjectPropertiesSection._isDisplayableProperty(i,e.property))continue;if(i.name==="__proto__"&&!i.isAccessorProperty()){l=i;continue}if(i.isOwn&&i.getter){const e=new SDK.RemoteObjectProperty("get "+i.name,i.getter,false);e.parentObject=r;c.push(e)}if(i.isOwn&&i.setter){const e=new SDK.RemoteObjectProperty("set "+i.name,i.setter,false);e.parentObject=r;c.push(e)}const s=i.getter||!i.isAccessorProperty();if(s&&i.name!=="__proto__")e.appendChild(new ObjectUI.ObjectPropertyTreeElement(i,o))}for(let t=0;t<c.length;++t)e.appendChild(new ObjectUI.ObjectPropertyTreeElement(c[t],o));if(!i&&l)e.appendChild(new ObjectUI.ObjectPropertyTreeElement(l,o));for(const t of n){t.parentObject=r;const n=new ObjectUI.ObjectPropertyTreeElement(t,o);if(t.name==="[[Entries]]")continue;e.appendChild(n)}ObjectUI.ObjectPropertyTreeElement._appendEmptyPlaceholderIfNeeded(e,s)}static _appendEmptyPlaceholderIfNeeded(e,t){if(e.childCount())return;const n=createElementWithClass("div","gray-info-message");n.textContent=t||Common.UIString("No properties");const i=new UI.TreeElement(n);e.appendChild(i)}static createRemoteObjectAccessorPropertySpan(e,t,n){const i=createElement("span");const r=i.createChild("span");r.textContent=Common.UIString("(...)");if(!e)return i;r.classList.add("object-value-calculate-value-button");r.title=Common.UIString("Invoke property getter");r.addEventListener("click",o,false);function o(i){i.consume();e.callFunction(s,[{value:JSON.stringify(t)}]).then(n)}function s(e){let t=this;const n=JSON.parse(e);for(let e=0,i=n.length;e<i;++e)t=t[n[e]];return t}return i}setSearchRegex(e,t){let n=UI.highlightedSearchResultClassName;if(t)n+=" "+t;this.revertHighlightChanges();this._applySearch(e,this.nameElement,n);const i=this.property.value.type;if(i!=="object")this._applySearch(e,this.valueElement,n);return!!this._highlightChanges.length}_applySearch(e,t,n){const i=[];const r=t.textContent;e.lastIndex=0;let o=e.exec(r);while(o){i.push(new TextUtils.SourceRange(o.index,o[0].length));o=e.exec(r)}if(i.length)UI.highlightRangesWithStyleClass(t,i,n,this._highlightChanges)}revertHighlightChanges(){UI.revertDomChanges(this._highlightChanges);this._highlightChanges=[]}async onpopulate(){const e=this.property.value;console.assert(e);const t=this.treeOutline?this.treeOutline._skipProto:true;const n=this.property.name!=="__proto__"?e:this.property.parentObject;await ObjectUI.ObjectPropertyTreeElement._populate(this,e,t,this._linkifier,undefined,undefined,undefined,n)}ondblclick(e){const t=e.target.isSelfOrDescendant(this.valueElement)||this.expandedValueElement&&e.target.isSelfOrDescendant(this.expandedValueElement);if(!this.property.value.customPreview()&&t&&(this.property.writable||this.property.setter))this._startEditing();return false}onattach(){this.update();this._updateExpandable()}onexpand(){this._showExpandedValueElement(true)}oncollapse(){this._showExpandedValueElement(false)}_showExpandedValueElement(e){if(!this.expandedValueElement)return;if(e)this._rowContainer.replaceChild(this.expandedValueElement,this.valueElement);else this._rowContainer.replaceChild(this.valueElement,this.expandedValueElement)}_createExpandedValueElement(e){const t=e.hasChildren&&!e.customPreview()&&e.subtype!=="node"&&e.type!=="function"&&(e.type!=="object"||e.preview);if(!t)return null;const n=createElementWithClass("span","value");if(e.description==="Object")n.textContent="";else n.setTextContentTruncatedIfNeeded(e.description||"");n.classList.add("object-value-"+(e.subtype||e.type));n.title=e.description||"";return n}update(){this.nameElement=ObjectUI.ObjectPropertiesSection.createNameElement(this.property.name,this.property.private);if(!this.property.enumerable)this.nameElement.classList.add("object-properties-section-dimmed");if(this.property.synthetic)this.nameElement.classList.add("synthetic-property");this._updatePropertyPath();const e=this.property.synthetic&&this.property.name==="[[Entries]]";if(e){this.valueElement=createElementWithClass("span","value")}else if(this.property.value){const e=this.property.name!=="__proto__";this.valueElement=ObjectUI.ObjectPropertiesSection.createValueElementWithCustomSupport(this.property.value,this.property.wasThrown,e,this.listItemElement,this._linkifier)}else if(this.property.getter){this.valueElement=ObjectUI.ObjectPropertyTreeElement.createRemoteObjectAccessorPropertySpan(this.property.parentObject,[this.property.name],this._onInvokeGetterClick.bind(this))}else{this.valueElement=createElementWithClass("span","object-value-undefined");this.valueElement.textContent=Common.UIString("<unreadable>");this.valueElement.title=Common.UIString("No property getter")}const t=this.valueElement.textContent;if(this.property.value&&t&&!this.property.wasThrown)this.expandedValueElement=this._createExpandedValueElement(this.property.value);this.listItemElement.removeChildren();if(e)this._rowContainer=UI.html`<span class='name-and-value'>${this.nameElement}</span>`;else this._rowContainer=UI.html`<span class='name-and-value'>${this.nameElement}: ${this.valueElement}</span>`;this.listItemElement.appendChild(this._rowContainer)}_updatePropertyPath(){if(this.nameElement.title)return;const e=this.property.name;if(this.property.synthetic){this.nameElement.title=e;return}const t=/^(_|\$|[A-Z])(_|\$|[A-Z]|\d)*$/i;const n=/^[1-9]\d*$/;const i=this.parent.nameElement&&!this.parent.property.synthetic?this.parent.nameElement.title:"";if(this.property.private||t.test(e))this.nameElement.title=i?`${i}.${e}`:e;else if(n.test(e))this.nameElement.title=i+"["+e+"]";else this.nameElement.title=i+'["'+JSON.stringify(e)+'"]'}_contextMenuFired(e){const t=new UI.ContextMenu(e);t.appendApplicableItems(this);if(this.property.symbol)t.appendApplicableItems(this.property.symbol);if(this.property.value)t.appendApplicableItems(this.property.value);if(!this.property.synthetic&&this.nameElement&&this.nameElement.title){const e=InspectorFrontendHost.copyText.bind(InspectorFrontendHost,this.nameElement.title);t.clipboardSection().appendItem(ls`Copy property path`,e)}if(this.property.parentObject instanceof SDK.LocalJSONObject){t.viewSection().appendItem(ls`Expand recursively`,this.expandRecursively.bind(this,Number.MAX_VALUE));t.viewSection().appendItem(ls`Collapse children`,this.collapseChildren.bind(this))}t.show()}_startEditing(){if(this._prompt||!this.treeOutline._editable||this._readOnly)return;this._editableDiv=this._rowContainer.createChild("span","editable-div");let e=this.property.value.description;if(this.property.value.type==="string"&&typeof e==="string")e='"'+e+'"';this._editableDiv.setTextContentTruncatedIfNeeded(e,Common.UIString("<string is too large to edit>"));const t=this._editableDiv.textContent;this.setExpandable(false);this.listItemElement.classList.add("editing-sub-part");this.valueElement.classList.add("hidden");this._prompt=new ObjectUI.ObjectPropertyPrompt;const n=this._prompt.attachAndStartEditing(this._editableDiv,this._editingCommitted.bind(this,t));n.classList.add("property-prompt");this.listItemElement.getComponentSelection().selectAllChildren(this._editableDiv);n.addEventListener("keydown",this._promptKeyDown.bind(this,t),false)}_editingEnded(){this._prompt.detach();delete this._prompt;this._editableDiv.remove();this._updateExpandable();this.listItemElement.scrollLeft=0;this.listItemElement.classList.remove("editing-sub-part")}_editingCancelled(){this.valueElement.classList.remove("hidden");this._editingEnded()}async _editingCommitted(e){const t=this._prompt.text();if(t===e){this._editingCancelled();return}this._editingEnded();await this._applyExpression(t)}_promptKeyDown(e,t){if(isEnterKey(t)){t.consume();this._editingCommitted(e);return}if(t.key==="Escape"){t.consume();this._editingCancelled();return}}async _applyExpression(e){const t=SDK.RemoteObject.toCallArgument(this.property.symbol||this.property.name);e=ObjectUI.JavaScriptREPL.wrapObjectLiteral(e.trim());if(this.property.synthetic){let t=false;if(e)t=await this.property.setSyntheticValue(e);if(t){const e=this.parent;e.invalidateChildren();e.onpopulate()}else{this.update()}return}const n=e?this.property.parentObject.setPropertyValue(t,e):this.property.parentObject.deleteProperty(t);const i=await n;if(i){this.update();return}if(!e){this.parent.removeChild(this)}else{const e=this.parent;e.invalidateChildren();e.onpopulate()}}_onInvokeGetterClick(e){if(!e.object)return;this.property.value=e.object;this.property.wasThrown=e.wasThrown;this.update();this.invalidateChildren();this._updateExpandable()}_updateExpandable(){if(this.property.value){this.setExpandable(!this.property.value.customPreview()&&this.property.value.hasChildren&&!this.property.wasThrown)}else{this.setExpandable(false)}}path(){return this.nameElement.title}};ObjectUI.ArrayGroupingTreeElement=class extends UI.TreeElement{constructor(e,t,n,i,r){super(String.sprintf("[%d … %d]",t,n),true);this.toggleOnClick=true;this._fromIndex=t;this._toIndex=n;this._object=e;this._readOnly=true;this._propertyCount=i;this._linkifier=r}static async _populateArray(e,t,n,i,r){await ObjectUI.ArrayGroupingTreeElement._populateRanges(e,t,n,i,true,r)}static async _populateRanges(e,t,n,i,r,o){const s=await t.callFunctionJSON(a,[{value:n},{value:i},{value:ObjectUI.ArrayGroupingTreeElement._bucketThreshold},{value:ObjectUI.ArrayGroupingTreeElement._sparseIterationThreshold},{value:ObjectUI.ArrayGroupingTreeElement._getOwnPropertyNamesThreshold}]);await c(s);function a(e,t,n,i,r){let o=null;const s=t-e>=i&&ArrayBuffer.isView(this);const a=s&&t-e>=r;function*c(n){if(t-e<i){for(let i=e;i<=t;++i){if(i in n)yield i}}else{o=o||Object.getOwnPropertyNames(n);for(let n=0;n<o.length;++n){const i=o[n];const r=i>>>0;if(""+r===i&&e<=r&&r<=t)yield r}}}let l=0;if(s){l=t-e+1}else{for(const e of c(this))++l}let p=l;if(l<=n)p=l;else p=Math.pow(n,Math.ceil(Math.log(l)/Math.log(n))-1);const u=[];if(s){for(let n=e;n<=t;n+=p){const e=n;let i=e+p-1;if(i>t)i=t;u.push([e,i,i-e+1])}}else{l=0;let e=-1;let t=0;for(const n of c(this)){if(e===-1)e=n;t=n;if(++l===p){u.push([e,t,l]);l=0;e=-1}}if(l>0)u.push([e,t,l])}return{ranges:u,skipGetOwnPropertyNames:a}}async function c(n){if(!n)return;const i=n.ranges;if(i.length===1){await ObjectUI.ArrayGroupingTreeElement._populateAsFragment(e,t,i[0][0],i[0][1],o)}else{for(let n=0;n<i.length;++n){const r=i[n][0];const s=i[n][1];const a=i[n][2];if(r===s){await ObjectUI.ArrayGroupingTreeElement._populateAsFragment(e,t,r,s,o)}else{e.appendChild(new ObjectUI.ArrayGroupingTreeElement(t,r,s,a,o))}}}if(r){await ObjectUI.ArrayGroupingTreeElement._populateNonIndexProperties(e,t,n.skipGetOwnPropertyNames,o)}}}static async _populateAsFragment(e,t,n,i,r){const o=await t.callFunction(l,[{value:n},{value:i},{value:ObjectUI.ArrayGroupingTreeElement._sparseIterationThreshold}]);if(!o.object||o.wasThrown)return;const s=o.object;const a=await s.getAllProperties(false,true);s.release();const c=a.properties;if(!c)return;c.sort(ObjectUI.ObjectPropertiesSection.CompareProperties);for(let t=0;t<c.length;++t){c[t].parentObject=this._object;const n=new ObjectUI.ObjectPropertyTreeElement(c[t],r);n._readOnly=true;e.appendChild(n)}function l(e,t,n){const i=Object.create(null);if(t-e<n){for(let n=e;n<=t;++n){if(n in this)i[n]=this[n]}}else{const n=Object.getOwnPropertyNames(this);for(let r=0;r<n.length;++r){const o=n[r];const s=o>>>0;if(String(s)===o&&e<=s&&s<=t)i[s]=this[s]}}return i}}static async _populateNonIndexProperties(e,t,n,i){const r=await t.callFunction(a,[{value:n}]);if(!r.object||r.wasThrown)return;const o=await r.object.getOwnProperties(true);r.object.release();if(!o.properties)return;const s=o.properties;s.sort(ObjectUI.ObjectPropertiesSection.CompareProperties);for(const t of s){t.parentObject=this._object;if(!ObjectUI.ObjectPropertiesSection._isDisplayableProperty(t,e.property))continue;const n=new ObjectUI.ObjectPropertyTreeElement(t,i);n._readOnly=true;e.appendChild(n)}function a(e){const t={__proto__:this.__proto__};if(e)return t;const n=Object.getOwnPropertyNames(this);for(let e=0;e<n.length;++e){const i=n[e];if(String(i>>>0)===i&&i>>>0!==4294967295)continue;const r=Object.getOwnPropertyDescriptor(this,i);if(r)Object.defineProperty(t,i,r)}return t}}async onpopulate(){if(this._propertyCount>=ObjectUI.ArrayGroupingTreeElement._bucketThreshold){await ObjectUI.ArrayGroupingTreeElement._populateRanges(this,this._object,this._fromIndex,this._toIndex,false,this._linkifier);return}await ObjectUI.ArrayGroupingTreeElement._populateAsFragment(this,this._object,this._fromIndex,this._toIndex,this._linkifier)}onattach(){this.listItemElement.classList.add("object-properties-section-name")}};ObjectUI.ArrayGroupingTreeElement._bucketThreshold=100;ObjectUI.ArrayGroupingTreeElement._sparseIterationThreshold=25e4;ObjectUI.ArrayGroupingTreeElement._getOwnPropertyNamesThreshold=5e5;ObjectUI.ObjectPropertyPrompt=class extends UI.TextPrompt{constructor(){super();this.initialize(ObjectUI.javaScriptAutocomplete.completionsForTextInCurrentContext.bind(ObjectUI.javaScriptAutocomplete))}};ObjectUI.ObjectPropertiesSectionExpandController=class{constructor(){this._expandedProperties=new Set}watchSection(e,t){t.addEventListener(UI.TreeOutline.Events.ElementAttached,this._elementAttached,this);t.addEventListener(UI.TreeOutline.Events.ElementExpanded,this._elementExpanded,this);t.addEventListener(UI.TreeOutline.Events.ElementCollapsed,this._elementCollapsed,this);t[ObjectUI.ObjectPropertiesSectionExpandController._treeOutlineId]=e;if(this._expandedProperties.has(e))t.expand()}stopWatchSectionsWithId(e){for(const t of this._expandedProperties){if(t.startsWith(e+":"))this._expandedProperties.delete(t)}}_elementAttached(e){const t=e.data;if(t.isExpandable()&&this._expandedProperties.has(this._propertyPath(t)))t.expand()}_elementExpanded(e){const t=e.data;this._expandedProperties.add(this._propertyPath(t))}_elementCollapsed(e){const t=e.data;this._expandedProperties.delete(this._propertyPath(t))}_propertyPath(e){const t=e[ObjectUI.ObjectPropertiesSectionExpandController._cachedPathSymbol];if(t)return t;let n=e;const i=e.treeOutline.objectTreeElement();let r;while(n!==i){let e="";if(n.property)e=n.property.name;else e=typeof n.title==="string"?n.title:n.title.textContent;r=e+(r?"."+r:"");n=n.parent}const o=e.treeOutline[ObjectUI.ObjectPropertiesSectionExpandController._treeOutlineId];r=o+(r?":"+r:"");e[ObjectUI.ObjectPropertiesSectionExpandController._cachedPathSymbol]=r;return r}};ObjectUI.ObjectPropertiesSectionExpandController._cachedPathSymbol=Symbol("cachedPath");ObjectUI.ObjectPropertiesSectionExpandController._treeOutlineId=Symbol("treeOutlineId");ObjectUI.ObjectPropertiesSection.Renderer=class{render(e,t){if(!(e instanceof SDK.RemoteObject))return Promise.reject(new Error("Can't render "+e));t=t||{};const n=t.title;const i=new ObjectUI.ObjectPropertiesSection(e,n);if(!n)i.titleLessMode();i.editable=!!t.editable;return Promise.resolve({node:i.element,tree:i})}};ObjectUI.JavaScriptAutocomplete=class{constructor(){this._expressionCache=new Map;SDK.consoleModel.addEventListener(SDK.ConsoleModel.Events.CommandEvaluated,this._clearCache,this);UI.context.addFlavorChangeListener(SDK.ExecutionContext,this._clearCache,this);SDK.targetManager.addModelListener(SDK.DebuggerModel,SDK.DebuggerModel.Events.DebuggerResumed,this._clearCache,this);SDK.targetManager.addModelListener(SDK.DebuggerModel,SDK.DebuggerModel.Events.DebuggerPaused,this._clearCache,this)}_clearCache(){this._expressionCache.clear()}async completionsForTextInCurrentContext(e,t,n){const i=e.trim();const[r,o]=await Promise.all([this._mapCompletions(i,t),this._completionsForExpression(i,t,n)]);return r.concat(o)}async argumentsHint(e){const t=await Formatter.formatterWorkerPool().findLastFunctionCall(e);if(!t)return null;const n=UI.context.flavor(SDK.ExecutionContext);if(!n)return null;const i=await n.evaluate({expression:t.baseExpression,objectGroup:"argumentsHint",includeCommandLineAPI:true,silent:true,returnByValue:false,generatePreview:false,throwOnSideEffect:t.possibleSideEffects,timeout:t.possibleSideEffects?500:undefined},false,false);if(!i||i.exceptionDetails||!i.object||i.object.type!=="function"){n.runtimeModel.releaseObjectGroup("argumentsHint");return null}const r=await this._argumentsForFunction(i.object,async()=>{const e=await n.evaluate({expression:t.receiver,objectGroup:"argumentsHint",includeCommandLineAPI:true,silent:true,returnByValue:false,generatePreview:false,throwOnSideEffect:t.possibleSideEffects,timeout:t.possibleSideEffects?500:undefined},false,false);return e&&!e.exceptionDetails?e.object:null},t.functionName);n.runtimeModel.releaseObjectGroup("argumentsHint");if(!r.length||r.length===1&&!r[0].length)return null;return{args:r,argumentIndex:t.argumentIndex}}async _argumentsForFunction(e,t,n){const i=e.description;if(!i.endsWith("{ [native code] }"))return[await Formatter.formatterWorkerPool().argumentsList(i)];if(i==="function () { [native code] }"){const t=await e.getOwnProperties(false);const n=t.internalProperties||[];const i=n.find(e=>e.name==="[[TargetFunction]]");const r=n.find(e=>e.name==="[[BoundArgs]]");const o=n.find(e=>e.name==="[[BoundThis]]");if(o&&i&&r){const e=await this._argumentsForFunction(i.value,()=>Promise.resolve(o.value));const t=SDK.RemoteObject.arrayLength(r.value);const n=[];for(const i of e){const e=i.slice(0,t).findIndex(e=>e.startsWith("..."));if(e!==-1)n.push(i.slice(e));else n.push(i.slice(t))}return n}}const r=await self.runtime.extension(Common.JavaScriptMetadata).instance();const o=/^function ([^(]*)\(/.exec(i)[1]||n;if(!o)return[];const s=r.signaturesForNativeFunction(o);if(s)return s;const a=await t();const c=a.className;if(r.signaturesForInstanceMethod(o,c))return r.signaturesForInstanceMethod(o,c);if(a.type==="function"&&a.description.endsWith("{ [native code] }")){const e=/^function ([^(]*)\(/.exec(a.description)[1];const t=r.signaturesForStaticMethod(o,e);if(t)return t}let l;if(a.type==="number"){l=["Number","Object"]}else if(a.type==="string"){l=["String","Object"]}else if(a.type==="symbol"){l=["Symbol","Object"]}else if(a.type==="bigint"){l=["BigInt","Object"]}else if(a.type==="boolean"){l=["Boolean","Object"]}else if(a.type==="undefined"||a.subtype==="null"){l=[]}else{l=await a.callFunctionJSON(function(){const e=[];for(let t=this;t;t=Object.getPrototypeOf(t)){if(typeof t==="object"&&t.constructor&&t.constructor.name)e[e.length]=t.constructor.name}return e})}for(const e of l){const t=r.signaturesForInstanceMethod(o,e);if(t)return t}return[]}async _mapCompletions(e,t){const n=e.match(/\.\s*(get|set|delete)\s*\(\s*$/);const i=UI.context.flavor(SDK.ExecutionContext);if(!i||!n)return[];const r=await Formatter.formatterWorkerPool().findLastExpression(e.substring(0,n.index));if(!r)return[];const o=await i.evaluate({expression:r.baseExpression,objectGroup:"mapCompletion",includeCommandLineAPI:true,silent:true,returnByValue:false,generatePreview:false,throwOnSideEffect:r.possibleSideEffects,timeout:r.possibleSideEffects?500:undefined},false,false);if(o.error||!!o.exceptionDetails||o.object.subtype!=="map")return[];const s=await o.object.getOwnProperties(false);const a=s.internalProperties||[];const c=a.find(e=>e.name==="[[Entries]]");if(!c)return[];const l=await c.value.callFunctionJSON(p);i.runtimeModel.releaseObjectGroup("mapCompletion");return u(Object.keys(l));function p(){const e={__proto__:null};for(let t=0;t<this.length;t++){if(typeof this[t].key==="string")e[this[t].key]=true}return e}function u(e){const i=[];const r=[];const o=[];const s=[];let a='"';if(t.startsWith("'"))a="'";let c=")";if(n[0].indexOf("set")!==-1)c=", ";const l=e.length<1e3?String.naturalOrderComparator:undefined;const p=e.sort(l).map(e=>a+e+a);for(const e of p){if(e.length<t.length)continue;if(t.length&&e.toLowerCase().indexOf(t.toLowerCase())===-1)continue;const n=e.split("\n").join("\\n");const a=n+c;if(e.startsWith(t))i.push({text:a,title:n,priority:4});else if(e.toLowerCase().startsWith(t.toLowerCase()))r.push({text:a,title:n,priority:3});else if(e.indexOf(t)!==-1)o.push({text:a,title:n,priority:2});else s.push({text:a,title:n,priority:1})}const u=i.concat(r,o,s);if(u.length)u[0].subtitle=Common.UIString("Keys");return u}}async _completionsForExpression(e,t,n){const i=UI.context.flavor(SDK.ExecutionContext);if(!i)return[];let r;if(e.endsWith(".")||e.endsWith("["))r=await Formatter.formatterWorkerPool().findLastExpression(e.substring(0,e.length-1));if(!r){if(e.endsWith("."))return[];r={baseExpression:"",possibleSideEffects:false}}const o=r.possibleSideEffects;const s=r.baseExpression;const a=e.endsWith(".");const c=!!s&&e.endsWith("[");if(s&&!isNaN(s)||!s&&t&&!isNaN(t))return[];if(!t&&!s&&!n)return[];const l=i.debuggerModel.selectedCallFrame();let p;const u=1e4;let d=this._expressionCache.get(s);if(d&&d.date+u>Date.now()){p=await d.value}else if(!s&&l){d={date:Date.now(),value:m(l)};this._expressionCache.set(s,d);p=await d.value}else{const e=i.evaluate({expression:s,objectGroup:"completion",includeCommandLineAPI:true,silent:true,returnByValue:false,generatePreview:false,throwOnSideEffect:o,timeout:o?500:undefined},false,false);d={date:Date.now(),value:e.then(e=>h.call(this,e))};this._expressionCache.set(s,d);p=await d.value}return this._receivedPropertyNames(p.slice(0),a,c,s,t);async function h(e){if(e.error||!!e.exceptionDetails||!e.object)return[];let t=e.object;while(t&&t.type==="object"&&t.subtype==="proxy"){const e=await t.getOwnProperties(false);const n=e.internalProperties||[];const i=n.find(e=>e.name==="[[Target]]");t=i?i.value:null}if(!t)return[];let n=[];if(t.type==="object"||t.type==="function"){n=await t.callFunctionJSON(r,[SDK.RemoteObject.toCallArgument(t.subtype)])||[]}else if(t.type==="string"||t.type==="number"||t.type==="boolean"||t.type==="bigint"){const e=await i.evaluate({expression:"("+r+')("'+t.type+'")',objectGroup:"completion",includeCommandLineAPI:false,silent:true,returnByValue:true,generatePreview:false},false,false);if(e.object&&!e.exceptionDetails)n=e.object.value||[]}i.runtimeModel.releaseObjectGroup("completion");if(!s){const e=await i.globalLexicalScopeNames();if(n.length)n[0].items=n[0].items.concat(e);else n.push({items:e.sort(),title:Common.UIString("Lexical scope variables")})}for(const e of n){for(let t=0;t<e.items.length;t++)e.items[t]=e.items[t].replace(/\n/g,"\\n");e.items.sort(e.items.length<1e3?this._itemComparator:undefined)}return n;function r(e){let t;if(e==="string")t=new String("");else if(e==="number")t=new Number(0);else if(e==="bigint")t=Object(BigInt(0));else if(e==="boolean")t=new Boolean(false);else t=this;const n=[];try{for(let i=t;i;i=Object.getPrototypeOf(i)){if((e==="array"||e==="typedarray")&&i===t&&i.length>9999)continue;const r={items:[],__proto__:null};try{if(typeof i==="object"&&Object.prototype.hasOwnProperty.call(i,"constructor")&&i.constructor&&i.constructor.name)r.title=i.constructor.name}catch(e){}n[n.length]=r;const o=Object.getOwnPropertyNames(i);const s=Array.isArray(i);for(let e=0;e<o.length&&r.items.length<1e4;++e){if(s&&/^[0-9]/.test(o[e]))continue;r.items[r.items.length]=o[e]}}}catch(e){}return n}}async function m(e){const t=[{items:["this"]}];const n=e.scopeChain();const r=[];for(const e of n){r.push(e.object().getAllProperties(false,false).then(t=>({properties:t.properties,name:e.name()})))}const o=await Promise.all(r);i.runtimeModel.releaseObjectGroup("completion");for(const e of o)t.push({title:e.name,items:e.properties.map(e=>e.name).sort()});return t}}_receivedPropertyNames(e,t,n,i,r){if(!e)return[];const o=!t&&!n;if(o){const t=["dir","dirxml","keys","values","profile","profileEnd","monitorEvents","unmonitorEvents","inspect","copy","clear","getEventListeners","debug","undebug","monitor","unmonitor","table","queryObjects","$","$$","$x","$0","$_"];e.push({items:t})}return this._completionsForQuery(t,n,i,r,e)}_completionsForQuery(e,t,n,i,r){const o=t&&i.startsWith("'")?"'":'"';if(!n){const e=["await","break","case","catch","class","const","continue","debugger","default","delete","do","else","exports","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","yield","let","static","async","of"];r.push({title:ls`keywords`,items:e.sort()})}const s=new Set;let a=[];let c;const l=/^[a-zA-Z_$\u008F-\uFFFF][a-zA-Z0-9_$\u008F-\uFFFF]*$/;const p=i.toLowerCase();for(const e of r){const n=[];const r=[];const u=[];const d=[];for(let a=0;a<e.items.length;a++){let c=e.items[a];if(!t&&!l.test(c))continue;if(t){if(!/^[0-9]+$/.test(c))c=o+c.escapeCharacters(o+"\\")+o;c+="]"}if(s.has(c))continue;if(c.length<i.length)continue;const h=c.toLowerCase();if(i.length&&h.indexOf(p)===-1)continue;s.add(c);if(c.startsWith(i))n.push({text:c,priority:c===i?5:4});else if(h.startsWith(p))r.push({text:c,priority:3});else if(c.indexOf(i)!==-1)u.push({text:c,priority:2});else d.push({text:c,priority:1})}const h=n.concat(r,u,d);if(h.length&&e.title!==c){h[0].subtitle=e.title;c=e.title}a=a.concat(h);a.forEach(e=>{if(e.text.endsWith("]"))e.title=e.text.substring(0,e.text.length-1)})}return a}_itemComparator(e,t){const n=e.startsWith("_");const i=t.startsWith("_");if(n&&!i)return 1;if(i&&!n)return-1;return String.naturalOrderComparator(e,t)}static async isExpressionComplete(e){const t=UI.context.flavor(SDK.ExecutionContext);if(!t)return true;const n=await t.runtimeModel.compileScript(e,"",false,t.id);if(!n.exceptionDetails)return true;const i=n.exceptionDetails.exception.description;return!i.startsWith("SyntaxError: Unexpected end of input")&&!i.startsWith("SyntaxError: Unterminated template literal")}};ObjectUI.JavaScriptAutocomplete.CompletionGroup;ObjectUI.javaScriptAutocomplete=new ObjectUI.JavaScriptAutocomplete;ObjectUI.JavaScriptAutocompleteConfig=class{constructor(e){this._editor=e}static createConfigForEditor(e){const t=new ObjectUI.JavaScriptAutocompleteConfig(e);return{substituteRangeCallback:t._substituteRange.bind(t),suggestionsCallback:t._suggestionsCallback.bind(t),tooltipCallback:t._tooltipCallback.bind(t)}}_substituteRange(e,t){const n=this._editor.tokenAtTextPosition(e,t);if(n&&n.type==="js-string")return new TextUtils.TextRange(e,n.startColumn,e,t);const i=this._editor.line(e);let r;for(r=t-1;r>=0;r--){if(" =:[({;,!+-*/&|^<>.\t\r\n".indexOf(i.charAt(r))!==-1)break}return new TextUtils.TextRange(e,r+1,e,t)}async _suggestionsCallback(e,t,n){const i=this._editor.text(e);const r=this._editor.text(new TextUtils.TextRange(0,0,e.startLine,e.startColumn));const o=this._editor.tokenAtTextPosition(t.startLine,t.startColumn);if(o){const e=new Set(["js-comment","js-string-2","js-def"]);const t=r.trim();if(!t.endsWith("[")&&!t.match(/\.\s*(get|set|delete)\s*\(\s*$/))e.add("js-string");if(!t.endsWith("."))e.add("js-property");if(e.has(o.type))return[]}const s=this._editor.line(e.startLine).substring(e.startColumn);const a=await ObjectUI.javaScriptAutocomplete.completionsForTextInCurrentContext(r,i,n);if(!n&&s&&s!==i&&a.some(e=>s.startsWith(e.text)&&i.length!==e.text.length))return[];return a}async _tooltipCallback(e,t){const n=this._editor.text(new TextUtils.TextRange(0,0,e,t));const i=await ObjectUI.javaScriptAutocomplete.argumentsHint(n);if(!i)return null;const r=i.argumentIndex;const o=createElement("div");for(const e of i.args){const t=createElement("span");for(let n=0;n<e.length;n++){if(n===r||n<r&&e[n].startsWith("..."))t.appendChild(UI.html`<b>${e[n]}</b>`);else t.createTextChild(e[n]);if(n<e.length-1)t.createTextChild(", ")}o.appendChild(UI.html`<div class='source-code'>\u0192(${t})</div>`)}return o}};ObjectUI.JavaScriptREPL=class{static wrapObjectLiteral(e){if(!(/^\s*\{/.test(e)&&/\}\s*$/.test(e)))return e;const t=(async()=>0).constructor;try{t("return "+e+";");const n="("+e+")";t(n);return n}catch(t){return e}}static async preprocessExpression(e){e=ObjectUI.JavaScriptREPL.wrapObjectLiteral(e);let t=false;if(e.indexOf("await")!==-1){const n=await Formatter.formatterWorkerPool().preprocessTopLevelAwaitExpressions(e);t=!!n;e=n||e}return{text:e,preprocessed:t}}static async evaluateAndBuildPreview(e,t,n,i,r){const o=UI.context.flavor(SDK.ExecutionContext);const s=e.length>ObjectUI.JavaScriptREPL._MaxLengthForEvaluation;if(!e||!o||t&&s)return{preview:createDocumentFragment(),result:null};const a=await ObjectUI.JavaScriptREPL.preprocessExpression(e);const c={expression:a.text,generatePreview:true,includeCommandLineAPI:true,throwOnSideEffect:t,timeout:n,objectGroup:r};const l=await o.evaluate(c,false,a.preprocessed);const p=ObjectUI.JavaScriptREPL._buildEvaluationPreview(l,i);return{preview:p,result:l}}static _buildEvaluationPreview(e,t){const n=createDocumentFragment();if(e.error)return n;if(e.exceptionDetails&&e.exceptionDetails.exception&&e.exceptionDetails.exception.description){const i=e.exceptionDetails.exception.description;if(i.startsWith("TypeError: ")||t)n.createChild("span").textContent=e.exceptionDetails.text+" "+i;return n}const i=new ObjectUI.RemoteObjectPreviewFormatter;const{preview:r,type:o,subtype:s,description:a}=e.object;if(r&&o==="object"&&s!=="node"){i.appendObjectPreview(n,r,false)}else{const e=i.renderPropertyPreview(o,s,a.trimEnd(400));n.appendChild(e)}return n}};ObjectUI.JavaScriptREPL._MaxLengthForEvaluation=2e3;ObjectUI.RemoteObjectPreviewFormatter=class{static _objectPropertyComparator(e,t){return n(e)-n(t);function n(e){const t=ObjectUI.RemoteObjectPreviewFormatter._internalName;if(e.name===t.PromiseStatus)return 1;else if(e.name===t.PromiseValue)return 2;else if(e.name===t.GeneratorStatus||e.name===t.PrimitiveValue)return 3;else if(e.type!=="function"&&!e.name.startsWith("#"))return 4;return 5}}appendObjectPreview(e,t,n){const i=t.description;const r=new Set(["null","regexp","error","internal#entry"]);if(t.type!=="object"||r.has(t.subtype)||n){e.appendChild(this.renderPropertyPreview(t.type,t.subtype,i));return}const o=t.subtype==="array"||t.subtype==="typedarray";if(i){let n;if(o){const e=SDK.RemoteObject.arrayLength(t);const r=e>1?"("+e+")":"";const o=SDK.RemoteObject.arrayNameFromDescription(i);n=o==="Array"?r:o+r}else{const e=i==="Object";n=e?"":i}if(n.length>0)e.createChild("span","object-description").textContent=n+" "}const s=e.createChild("span","object-properties-preview");s.createTextChild(o?"[":"{");if(t.entries)this._appendEntriesPreview(s,t);else if(o)this._appendArrayPropertiesPreview(s,t);else this._appendObjectPropertiesPreview(s,t);if(t.overflow){const e=s.textContent.length>1?", …":"…";s.createChild("span").textContent=e}s.createTextChild(o?"]":"}")}_abbreviateFullQualifiedClassName(e){const t=e.split(".");for(let e=0;e<t.length-1;++e)t[e]=t[e].trimMiddle(3);return t.join(".")}_appendObjectPropertiesPreview(e,t){const n=ObjectUI.RemoteObjectPreviewFormatter._internalName;const i=t.properties.filter(e=>e.type!=="accessor").stableSort(ObjectUI.RemoteObjectPreviewFormatter._objectPropertyComparator);for(let r=0;r<i.length;++r){if(r>0)e.createTextChild(", ");const o=i[r];const s=o.name;if(t.subtype==="promise"&&s===n.PromiseStatus){e.appendChild(this._renderDisplayName("<"+o.value+">"));const t=r+1<i.length?i[r+1]:null;if(t&&t.name===n.PromiseValue){if(o.value!=="pending"){e.createTextChild(": ");e.appendChild(this._renderPropertyPreviewOrAccessor([t]))}r++}}else if(t.subtype==="generator"&&s===n.GeneratorStatus){e.appendChild(this._renderDisplayName("<"+o.value+">"))}else if(s===n.PrimitiveValue){e.appendChild(this._renderPropertyPreviewOrAccessor([o]))}else{e.appendChild(this._renderDisplayName(s));e.createTextChild(": ");e.appendChild(this._renderPropertyPreviewOrAccessor([o]))}}}_appendArrayPropertiesPreview(e,t){const n=SDK.RemoteObject.arrayLength(t);const i=t.properties.filter(e=>s(e.name)!==-1).stableSort(o);const r=t.properties.filter(e=>s(e.name)===-1).stableSort(ObjectUI.RemoteObjectPreviewFormatter._objectPropertyComparator);function o(e,t){return s(e.name)-s(t.name)}function s(e){const t=e>>>0;if(String(t)===e&&t<n)return t;return-1}const a=!t.overflow;let c=-1;let l=false;for(let t=0;t<i.length;++t){if(l)e.createTextChild(", ");const n=i[t];const r=s(n.name);if(a&&r-c>1){p(r);e.createTextChild(", ")}if(!a&&t!==r){e.appendChild(this._renderDisplayName(n.name));e.createTextChild(": ")}e.appendChild(this._renderPropertyPreviewOrAccessor([n]));c=r;l=true}if(a&&n-c>1){if(l)e.createTextChild(", ");p(n)}for(let t=0;t<r.length;++t){if(l)e.createTextChild(", ");const n=r[t];e.appendChild(this._renderDisplayName(n.name));e.createTextChild(": ");e.appendChild(this._renderPropertyPreviewOrAccessor([n]));l=true}function p(t){const n=e.createChild("span","object-value-undefined");const i=t-c-1;n.textContent=i!==1?Common.UIString("empty × %d",i):Common.UIString("empty");l=true}}_appendEntriesPreview(e,t){for(let n=0;n<t.entries.length;++n){if(n>0)e.createTextChild(", ");const i=t.entries[n];if(i.key){this.appendObjectPreview(e,i.key,true);e.createTextChild(" => ")}this.appendObjectPreview(e,i.value,true)}}_renderDisplayName(e){const t=createElementWithClass("span","name");const n=/^\s|\s$|^$|\n/.test(e);t.textContent=n?'"'+e.replace(/\n/g,"↵")+'"':e;return t}_renderPropertyPreviewOrAccessor(e){const t=e.peekLast();return this.renderPropertyPreview(t.type,t.subtype,t.value)}renderPropertyPreview(e,t,n){const i=createElementWithClass("span","object-value-"+(t||e));n=n||"";if(e==="accessor"){i.textContent="(...)";i.title=Common.UIString("The property is computed with a getter");return i}if(e==="function"){i.textContent="ƒ";return i}if(e==="object"&&t==="node"&&n){ObjectUI.RemoteObjectPreviewFormatter.createSpansForNodeTitle(i,n);return i}if(e==="string"){i.createTextChildren('"',n.replace(/\n/g,"↵"),'"');return i}if(e==="object"&&!t){let e=this._abbreviateFullQualifiedClassName(n);if(e==="Object")e="{…}";i.textContent=e;i.title=n;return i}i.textContent=n;return i}};ObjectUI.RemoteObjectPreviewFormatter._internalName={GeneratorStatus:"[[GeneratorStatus]]",PrimitiveValue:"[[PrimitiveValue]]",PromiseStatus:"[[PromiseStatus]]",PromiseValue:"[[PromiseValue]]"};ObjectUI.RemoteObjectPreviewFormatter.createSpansForNodeTitle=function(e,t){const n=t.match(/([^#.]+)(#[^.]+)?(\..*)?/);e.createChild("span","webkit-html-tag-name").textContent=n[1];if(n[2])e.createChild("span","webkit-html-attribute-value").textContent=n[2];if(n[3])e.createChild("span","webkit-html-attribute-name").textContent=n[3]};Runtime.cachedResources["object_ui/customPreviewComponent.css"]="/*\n * Copyright (c) 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.custom-expandable-section {\n    display: inline-flex;\n    flex-direction: column;\n}\n\n.custom-expand-icon {\n    -webkit-user-select: none;\n    opacity: 0.5;\n    margin-right: 4px;\n    margin-bottom: -2px;\n    background: black;\n}\n\n.custom-expandable-section-standard-section {\n    display: inline-flex;\n}";Runtime.cachedResources["object_ui/objectPopover.css"]="/*\n * Copyright 2017 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.object-popover-content {\n    display: block;\n    position: relative;\n    overflow: hidden;\n    flex: 1 1 auto;\n}\n\n.object-popover-title {\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    font-weight: bold;\n    padding-left: 18px;\n    padding-bottom: 2px;\n}\n\n.object-popover-tree {\n    border-top: 1px solid rgb(184, 184, 184);\n    overflow: auto;\n    width: 100%;\n    height: calc(100% - 13px);\n}\n\n.object-popover-container {\n    display: inline-block;\n}\n\n.function-popover-title {\n    border-bottom: 1px solid #AAA;\n    margin-bottom: 3px;\n    padding-bottom: 2px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.function-popover-title .function-name {\n    font-weight: bold;\n}\n\n.function-title-link-container {\n    display: flex;\n    align-items: center;\n    position: relative;\n    margin-left: 10px;\n}\n\n.function-title-link-container .devtools-link {\n    white-space: nowrap;\n    overflow: hidden;\n}\n";Runtime.cachedResources["object_ui/objectPropertiesSection.css"]='/*\n * Copyright 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.object-properties-section-dimmed {\n    opacity: 0.6;\n}\n\n.object-properties-section {\n    padding: 0 0 0px 0px;\n    color: rgb(33,33,33) !important;\n    display: flex;\n    flex-direction: column;\n}\n\n.object-properties-section li {\n    -webkit-user-select: text;\n}\n\n.object-properties-section li::before {\n    top: -1px;\n}\n\n.object-properties-section li.editing-sub-part {\n    padding: 3px 12px 8px 6px;\n    margin: -1px -6px -8px -6px;\n    text-overflow: clip;\n}\n\n.object-properties-section li.editing {\n    margin-left: 10px;\n    text-overflow: clip;\n}\n\n.tree-outline ol.title-less-mode {\n    padding-left: 0px;\n}\n\n.object-properties-section .synthetic-property {\n    font-style: italic;\n}\n\n.object-properties-section .private-property-hash {\n    color: #222;\n}\n\n.object-properties-section-root-element {\n    display: flex;\n    flex-direction: row;\n}\n\n.object-properties-section .editable-div {\n    overflow: hidden;\n}\n\n.name-and-value {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    line-height: 16px;\n}\n\n.editing-sub-part .name-and-value {\n    overflow: visible;\n    display: inline-flex;\n}\n\n.property-prompt {\n    margin-left: 4px;\n}\n\n.tree-outline.hide-selection-when-blurred .selected:focus[data-keyboard-focus="true"] {\n    background: none;\n}\n\n.tree-outline.hide-selection-when-blurred .selected:focus[data-keyboard-focus="true"] ::slotted(*),\n.tree-outline.hide-selection-when-blurred .selected:focus[data-keyboard-focus="true"] .tree-element-title,\n.tree-outline.hide-selection-when-blurred .selected:focus[data-keyboard-focus="true"] .name-and-value {\n    background: var(--focus-bg-color);\n    border-radius: 2px;\n    box-shadow: 0px 0px 0px 2px var(--focus-bg-color);\n}\n';Runtime.cachedResources["object_ui/objectValue.css"]="/*\n * Copyright 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.object-value-scientific-notation-exponent {\n    flex-shrink: 0;\n}\n\n.object-value-scientific-notation-mantissa {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    flex-shrink: 1;\n    min-width: 1ex;\n}\n\n.object-value-scientific-notation-number {\n    display: flex !important;\n}\n\n.value.object-value-node:hover {\n    background-color: rgba(56, 121, 217, 0.1);\n}\n\n.object-value-function-prefix,\n.object-value-boolean {\n    color: rgb(13, 34, 170);\n}\n\n.object-value-function {\n    font-style: italic;\n}\n\n.object-value-function.linkified:hover {\n    background-color: rgba(0, 0, 0, 0.1);\n    cursor: pointer;\n}\n\n.object-value-number {\n    color: rgb(28, 0, 207);\n}\n\n.object-value-bigint {\n    color: rgb(0, 93, 0);\n}\n\n.object-value-string,\n.object-value-regexp,\n.object-value-symbol {\n    white-space: pre;\n    unicode-bidi: -webkit-isolate;\n    color: rgb(196, 26, 22);\n}\n\n.object-value-string-quote {\n    color: #222;\n}\n\n.object-value-node {\n    position: relative;\n    vertical-align: baseline;\n    color: rgb(48, 57, 66);\n    display: inline-block;\n}\n\n.object-value-null,\n.object-value-undefined {\n    color: rgb(128, 128, 128);\n}\n\n.object-value-calculate-value-button:hover {\n    text-decoration: underline;\n}\n\n.object-properties-section-custom-section {\n    display: inline-flex;\n    flex-direction: column;\n}\n\n.-theme-with-dark-background .object-value-number,\n:host-context(.-theme-with-dark-background) .object-value-number,\n.-theme-with-dark-background .object-value-boolean,\n:host-context(.-theme-with-dark-background) .object-value-boolean {\n    color: hsl(252, 100%, 75%);\n}\n\n.object-properties-section .object-description {\n    color: gray;\n}\n\n.value .object-properties-preview {\n    white-space: nowrap;\n}\n\n.name {\n    color: rgb(136, 19, 145);\n    flex-shrink: 0;\n}\n\n.object-properties-preview .name {\n    color: #565656;\n}\n";