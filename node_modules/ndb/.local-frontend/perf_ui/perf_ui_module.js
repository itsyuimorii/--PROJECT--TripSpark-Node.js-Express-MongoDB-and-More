self["PerfUI"]=self["PerfUI"]||{};PerfUI.ChartViewportDelegate=function(){};PerfUI.ChartViewportDelegate.prototype={windowChanged(e,t,i){},updateRangeSelection(e,t){},setSize(e,t){},update(){}};PerfUI.ChartViewport=class extends UI.VBox{constructor(e){super();this.registerRequiredCSS("perf_ui/chartViewport.css");this._delegate=e;this.viewportElement=this.contentElement.createChild("div","fill");this.viewportElement.addEventListener("mousemove",this._updateCursorPosition.bind(this),false);this.viewportElement.addEventListener("mouseout",this._onMouseOut.bind(this),false);this.viewportElement.addEventListener("mousewheel",this._onMouseWheel.bind(this),false);this.viewportElement.addEventListener("keydown",this._onChartKeyDown.bind(this),false);this.viewportElement.addEventListener("keyup",this._onChartKeyUp.bind(this),false);UI.installDragHandle(this.viewportElement,this._startDragging.bind(this),this._dragging.bind(this),this._endDragging.bind(this),"-webkit-grabbing",null);UI.installDragHandle(this.viewportElement,this._startRangeSelection.bind(this),this._rangeSelectionDragging.bind(this),this._endRangeSelection.bind(this),"text",null);this._alwaysShowVerticalScroll=false;this._rangeSelectionEnabled=true;this._vScrollElement=this.contentElement.createChild("div","chart-viewport-v-scroll");this._vScrollContent=this._vScrollElement.createChild("div");this._vScrollElement.addEventListener("scroll",this._onScroll.bind(this),false);this._selectionOverlay=this.contentElement.createChild("div","chart-viewport-selection-overlay hidden");this._selectedTimeSpanLabel=this._selectionOverlay.createChild("div","time-span");this._cursorElement=this.contentElement.createChild("div","chart-cursor-element hidden");this.reset()}alwaysShowVerticalScroll(){this._alwaysShowVerticalScroll=true;this._vScrollElement.classList.add("always-show-scrollbar")}disableRangeSelection(){this._rangeSelectionEnabled=false;this._rangeSelectionStart=null;this._rangeSelectionEnd=null;this._updateRangeSelectionOverlay()}isDragging(){return this._isDragging}elementsToRestoreScrollPositionsFor(){return[this._vScrollElement]}_updateScrollBar(){const e=this._alwaysShowVerticalScroll||this._totalHeight>this._offsetHeight;if(this._vScrollElement.classList.contains("hidden")!==e)return;this._vScrollElement.classList.toggle("hidden",!e);this._updateContentElementSize()}onResize(){this._updateScrollBar();this._updateContentElementSize();this.scheduleUpdate()}reset(){this._vScrollElement.scrollTop=0;this._scrollTop=0;this._rangeSelectionStart=null;this._rangeSelectionEnd=null;this._isDragging=false;this._dragStartPointX=0;this._dragStartPointY=0;this._dragStartScrollTop=0;this._visibleLeftTime=0;this._visibleRightTime=0;this._offsetWidth=0;this._offsetHeight=0;this._totalHeight=0;this._targetLeftTime=0;this._targetRightTime=0;this._updateContentElementSize()}_updateContentElementSize(){let e=this._vScrollElement.offsetLeft;if(!e)e=this.contentElement.offsetWidth;this._offsetWidth=e;this._offsetHeight=this.contentElement.offsetHeight;this._delegate.setSize(this._offsetWidth,this._offsetHeight)}setContentHeight(e){this._totalHeight=e;this._vScrollContent.style.height=e+"px";this._updateScrollBar();if(this._scrollTop+this._offsetHeight<=e)return;this._scrollTop=Math.max(0,e-this._offsetHeight);this._vScrollElement.scrollTop=this._scrollTop}setScrollOffset(e,t){t=t||0;if(this._vScrollElement.scrollTop>e)this._vScrollElement.scrollTop=e;else if(this._vScrollElement.scrollTop<e-this._offsetHeight+t)this._vScrollElement.scrollTop=e-this._offsetHeight+t}scrollOffset(){return this._vScrollElement.scrollTop}setBoundaries(e,t){this._minimumBoundary=e;this._totalTime=t}_onMouseWheel(e){const t=e.shiftKey^Common.moduleSetting("flamechartMouseWheelAction").get()==="zoom";const i=!t&&(e.wheelDeltaY||Math.abs(e.wheelDeltaX)===120);const s=t&&Math.abs(e.wheelDeltaX)>Math.abs(e.wheelDeltaY);if(i){this._vScrollElement.scrollTop-=(e.wheelDeltaY||e.wheelDeltaX)/120*this._offsetHeight/8}else if(s){this._handlePanGesture(-e.wheelDeltaX,true)}else{const t=1/120;this._handleZoomGesture(Math.pow(1.2,-(e.wheelDeltaY||e.wheelDeltaX)*t)-1)}e.consume(true)}_startDragging(e){if(e.shiftKey)return false;this._isDragging=true;this._dragStartPointX=e.pageX;this._dragStartPointY=e.pageY;this._dragStartScrollTop=this._vScrollElement.scrollTop;this.viewportElement.style.cursor="";return true}_dragging(e){const t=this._dragStartPointX-e.pageX;this._dragStartPointX=e.pageX;this._handlePanGesture(t);const i=this._dragStartPointY-e.pageY;this._vScrollElement.scrollTop=this._dragStartScrollTop+i}_endDragging(){this._isDragging=false}_startRangeSelection(e){if(!e.shiftKey||!this._rangeSelectionEnabled)return false;this._isDragging=true;this._selectionOffsetShiftX=e.offsetX-e.pageX;this._selectionOffsetShiftY=e.offsetY-e.pageY;this._selectionStartX=e.offsetX;const t=this._selectionOverlay.style;t.left=this._selectionStartX+"px";t.width="1px";this._selectedTimeSpanLabel.textContent="";this._selectionOverlay.classList.remove("hidden");return true}_endRangeSelection(){this._isDragging=false;this._selectionStartX=null}hideRangeSelection(){this._selectionOverlay.classList.add("hidden");this._rangeSelectionStart=null;this._rangeSelectionEnd=null}setRangeSelection(e,t){if(!this._rangeSelectionEnabled)return;this._rangeSelectionStart=Math.min(e,t);this._rangeSelectionEnd=Math.max(e,t);this._updateRangeSelectionOverlay();this._delegate.updateRangeSelection(this._rangeSelectionStart,this._rangeSelectionEnd)}onClick(e){const t=this.pixelToTime(e.offsetX);if(this._rangeSelectionStart!==null&&t>=this._rangeSelectionStart&&t<=this._rangeSelectionEnd)return;this.hideRangeSelection()}_rangeSelectionDragging(e){const t=Number.constrain(e.pageX+this._selectionOffsetShiftX,0,this._offsetWidth);const i=this.pixelToTime(this._selectionStartX);const s=this.pixelToTime(t);this.setRangeSelection(i,s)}_updateRangeSelectionOverlay(){const e=100;const t=Number.constrain(this.timeToPosition(this._rangeSelectionStart),-e,this._offsetWidth+e);const i=Number.constrain(this.timeToPosition(this._rangeSelectionEnd),-e,this._offsetWidth+e);const s=this._selectionOverlay.style;s.left=t+"px";s.width=i-t+"px";const n=this._rangeSelectionEnd-this._rangeSelectionStart;this._selectedTimeSpanLabel.textContent=Number.preciseMillisToString(n,2)}_onScroll(){this._scrollTop=this._vScrollElement.scrollTop;this.scheduleUpdate()}_onMouseOut(){this._lastMouseOffsetX=-1;this._showCursor(false)}_updateCursorPosition(e){this._showCursor(e.shiftKey);this._cursorElement.style.left=e.offsetX+"px";this._lastMouseOffsetX=e.offsetX}pixelToTime(e){return this.pixelToTimeOffset(e)+this._visibleLeftTime}pixelToTimeOffset(e){return e*(this._visibleRightTime-this._visibleLeftTime)/this._offsetWidth}timeToPosition(e){return Math.floor((e-this._visibleLeftTime)/(this._visibleRightTime-this._visibleLeftTime)*this._offsetWidth)}timeToPixel(){return this._offsetWidth/(this._visibleRightTime-this._visibleLeftTime)}_showCursor(e){this._cursorElement.classList.toggle("hidden",!e||this._isDragging)}_onChartKeyDown(e){this._showCursor(e.shiftKey);this._handleZoomPanKeys(e)}_onChartKeyUp(e){this._showCursor(e.shiftKey)}_handleZoomPanKeys(e){if(!UI.KeyboardShortcut.hasNoModifiers(e))return;const t=e.shiftKey?.8:.3;const i=e.shiftKey?320:160;switch(e.code){case"KeyA":this._handlePanGesture(-i,true);break;case"KeyD":this._handlePanGesture(i,true);break;case"KeyW":this._handleZoomGesture(-t);break;case"KeyS":this._handleZoomGesture(t);break;default:return}e.consume(true)}_handleZoomGesture(e){const t={left:this._targetLeftTime,right:this._targetRightTime};const i=this.pixelToTime(this._lastMouseOffsetX);t.left+=(t.left-i)*e;t.right+=(t.right-i)*e;this._requestWindowTimes(t,true)}_handlePanGesture(e,t){const i={left:this._targetLeftTime,right:this._targetRightTime};const s=Number.constrain(this.pixelToTimeOffset(e),this._minimumBoundary-i.left,this._totalTime+this._minimumBoundary-i.right);i.left+=s;i.right+=s;this._requestWindowTimes(i,!!t)}_requestWindowTimes(e,t){const i=this._minimumBoundary+this._totalTime;if(e.left<this._minimumBoundary){e.right=Math.min(e.right+this._minimumBoundary-e.left,i);e.left=this._minimumBoundary}else if(e.right>i){e.left=Math.max(e.left-e.right+i,this._minimumBoundary);e.right=i}if(e.right-e.left<PerfUI.FlameChart.MinimalTimeWindowMs)return;this._delegate.windowChanged(e.left,e.right,t)}scheduleUpdate(){if(this._updateTimerId||this._cancelWindowTimesAnimation)return;this._updateTimerId=this.element.window().requestAnimationFrame(()=>{this._updateTimerId=0;this._update()})}_update(){this._updateRangeSelectionOverlay();this._delegate.update()}setWindowTimes(e,t,i){if(e===this._targetLeftTime&&t===this._targetRightTime)return;if(!i||this._visibleLeftTime===0||this._visibleRightTime===Infinity||e===0&&t===Infinity||e===Infinity&&t===Infinity){this._targetLeftTime=e;this._targetRightTime=t;this._visibleLeftTime=e;this._visibleRightTime=t;this.scheduleUpdate();return}if(this._cancelWindowTimesAnimation){this._cancelWindowTimesAnimation();this._visibleLeftTime=this._targetLeftTime;this._visibleRightTime=this._targetRightTime}this._targetLeftTime=e;this._targetRightTime=t;this._cancelWindowTimesAnimation=UI.animateFunction(this.element.window(),s.bind(this),[{from:this._visibleLeftTime,to:e},{from:this._visibleRightTime,to:t}],100,()=>this._cancelWindowTimesAnimation=null);function s(e,t){this._visibleLeftTime=e;this._visibleRightTime=t;this._update()}}windowLeftTime(){return this._visibleLeftTime}windowRightTime(){return this._visibleRightTime}};PerfUI.FilmStripView=class extends UI.HBox{constructor(){super(true);this.registerRequiredCSS("perf_ui/filmStripView.css");this.contentElement.classList.add("film-strip-view");this._statusLabel=this.contentElement.createChild("div","label");this.reset();this.setMode(PerfUI.FilmStripView.Modes.TimeBased)}static _setImageData(e,t){if(t)e.src="data:image/jpg;base64,"+t}setMode(e){this._mode=e;this.contentElement.classList.toggle("time-based",e===PerfUI.FilmStripView.Modes.TimeBased);this.update()}setModel(e,t,i){this._model=e;this._zeroTime=t;this._spanTime=i;const s=e.frames();if(!s.length){this.reset();return}this.update()}createFrameElement(e){const t=e.timestamp;const i=createElementWithClass("div","frame");i.title=Common.UIString("Doubleclick to zoom image. Click to view preceding requests.");i.createChild("div","time").textContent=Number.millisToString(t-this._zeroTime);const s=i.createChild("div","thumbnail").createChild("img");i.addEventListener("mousedown",this._onMouseEvent.bind(this,PerfUI.FilmStripView.Events.FrameSelected,t),false);i.addEventListener("mouseenter",this._onMouseEvent.bind(this,PerfUI.FilmStripView.Events.FrameEnter,t),false);i.addEventListener("mouseout",this._onMouseEvent.bind(this,PerfUI.FilmStripView.Events.FrameExit,t),false);i.addEventListener("dblclick",this._onDoubleClick.bind(this,e),false);return e.imageDataPromise().then(PerfUI.FilmStripView._setImageData.bind(null,s)).then(n);function n(){return i}}frameByTime(e){function t(e,t){return e-t.timestamp}const i=this._model.frames();const s=Math.max(i.upperBound(e,t)-1,0);return i[s]}update(){if(!this._model)return;const e=this._model.frames();if(!e.length)return;if(this._mode===PerfUI.FilmStripView.Modes.FrameBased){Promise.all(e.map(this.createFrameElement.bind(this))).then(n.bind(this));return}const t=this.contentElement.clientWidth;const i=this._spanTime/t;this.createFrameElement(e[0]).then(s.bind(this));function s(e){const s=Math.ceil(UI.measurePreferredSize(e,this.contentElement).width);if(!s)return;const r=[];for(let e=s;e<t;e+=s){const t=e*i+this._zeroTime;r.push(this.createFrameElement(this.frameByTime(t)).then(o))}Promise.all(r).then(n.bind(this));function o(e){e.style.width=s+"px";return e}}function n(e){this.contentElement.removeChildren();for(let t=0;t<e.length;++t)this.contentElement.appendChild(e[t])}}onResize(){if(this._mode===PerfUI.FilmStripView.Modes.FrameBased)return;this.update()}_onMouseEvent(e,t){this.dispatchEventToListeners(e,t)}_onDoubleClick(e){new PerfUI.FilmStripView.Dialog(e,this._zeroTime)}reset(){this._zeroTime=0;this.contentElement.removeChildren();this.contentElement.appendChild(this._statusLabel)}setStatusText(e){this._statusLabel.textContent=e}};PerfUI.FilmStripView.Events={FrameSelected:Symbol("FrameSelected"),FrameEnter:Symbol("FrameEnter"),FrameExit:Symbol("FrameExit")};PerfUI.FilmStripView.Modes={TimeBased:"TimeBased",FrameBased:"FrameBased"};PerfUI.FilmStripView.Dialog=class{constructor(e,t){const i=UI.createTextButton("◀",this._onPrevFrame.bind(this));i.title=Common.UIString("Previous frame");const s=UI.createTextButton("▶",this._onNextFrame.bind(this));s.title=Common.UIString("Next frame");this._fragment=UI.Fragment.build`
      <x-widget flex=none margin=12px>
        <x-hbox overflow=auto border='1px solid #ddd' max-height=80vh max-width=80vw>
          <img $=image></img>
        </x-hbox>
        <x-hbox x-center justify-content=center margin-top=10px>
          ${i}
          <x-hbox $=time margin=8px></x-hbox>
          ${s}
        </x-hbox>
      </x-widget>
    `;this._widget=this._fragment.element();this._widget.tabIndex=0;this._widget.addEventListener("keydown",this._keyDown.bind(this),false);this._frames=e.model().frames();this._index=e.index;this._zeroTime=t||e.model().zeroTime();this._dialog=null;this._render()}_resize(){if(!this._dialog){this._dialog=new UI.Dialog;this._dialog.contentElement.appendChild(this._widget);this._dialog.setDefaultFocusedElement(this._widget);this._dialog.show()}this._dialog.setSizeBehavior(UI.GlassPane.SizeBehavior.MeasureContent)}_keyDown(e){switch(e.key){case"ArrowLeft":if(Host.isMac()&&e.metaKey)this._onFirstFrame();else this._onPrevFrame();break;case"ArrowRight":if(Host.isMac()&&e.metaKey)this._onLastFrame();else this._onNextFrame();break;case"Home":this._onFirstFrame();break;case"End":this._onLastFrame();break}}_onPrevFrame(){if(this._index>0)--this._index;this._render()}_onNextFrame(){if(this._index<this._frames.length-1)++this._index;this._render()}_onFirstFrame(){this._index=0;this._render()}_onLastFrame(){this._index=this._frames.length-1;this._render()}_render(){const e=this._frames[this._index];this._fragment.$("time").textContent=Number.millisToString(e.timestamp-this._zeroTime);return e.imageDataPromise().then(PerfUI.FilmStripView._setImageData.bind(null,this._fragment.$("image"))).then(this._resize.bind(this))}};PerfUI.FlameChartDelegate=function(){};PerfUI.FlameChartDelegate.prototype={windowChanged(e,t,i){},updateRangeSelection(e,t){},updateSelectedGroup(e,t){}};PerfUI.FlameChart=class extends UI.VBox{constructor(e,t,i){super(true);this.registerRequiredCSS("perf_ui/flameChart.css");this.contentElement.classList.add("flame-chart-main-pane");this._groupExpansionSetting=i;this._groupExpansionState=i&&i.get()||{};this._flameChartDelegate=t;this._useWebGL=Runtime.experiments.isEnabled("timelineWebGL");this._chartViewport=new PerfUI.ChartViewport(this);this._chartViewport.show(this.contentElement);this._dataProvider=e;this._viewportElement=this._chartViewport.viewportElement;if(this._useWebGL){this._canvasGL=this._viewportElement.createChild("canvas","fill");this._initWebGL()}this._canvas=this._viewportElement.createChild("canvas","fill");this._canvas.tabIndex=0;UI.ARIAUtils.setAccessibleName(this._canvas,ls`Flame Chart`);UI.ARIAUtils.markAsTree(this._canvas);this.setDefaultFocusedElement(this._canvas);this._canvas.classList.add("flame-chart-canvas");this._canvas.addEventListener("mousemove",this._onMouseMove.bind(this),false);this._canvas.addEventListener("mouseout",this._onMouseOut.bind(this),false);this._canvas.addEventListener("click",this._onClick.bind(this),false);this._canvas.addEventListener("keydown",this._onKeyDown.bind(this),false);this._entryInfo=this._viewportElement.createChild("div","flame-chart-entry-info");this._markerHighlighElement=this._viewportElement.createChild("div","flame-chart-marker-highlight-element");this._highlightElement=this._viewportElement.createChild("div","flame-chart-highlight-element");this._selectedElement=this._viewportElement.createChild("div","flame-chart-selected-element");UI.installDragHandle(this._viewportElement,this._startDragging.bind(this),this._dragging.bind(this),this._endDragging.bind(this),null);this._rulerEnabled=true;this._rangeSelectionStart=0;this._rangeSelectionEnd=0;this._barHeight=17;this._textBaseline=5;this._textPadding=5;this._markerRadius=6;this._chartViewport.setWindowTimes(e.minimumBoundary(),e.minimumBoundary()+e.totalTime());this._headerLeftPadding=6;this._arrowSide=8;this._expansionArrowIndent=this._headerLeftPadding+this._arrowSide/2;this._headerLabelXPadding=3;this._headerLabelYPadding=2;this._highlightedMarkerIndex=-1;this._highlightedEntryIndex=-1;this._selectedEntryIndex=-1;this._rawTimelineDataLength=0;this._textWidth=new Map;this._markerPositions=new Map;this._lastMouseOffsetX=0;this._selectedGroup=-1;this._keyboardFocusedGroup=-1;this._selectedGroupBackroundColor=UI.themeSupport.patchColorText(PerfUI.FlameChart.Colors.SelectedGroupBackground,UI.ThemeSupport.ColorUsage.Background);this._selectedGroupBorderColor=UI.themeSupport.patchColorText(PerfUI.FlameChart.Colors.SelectedGroupBorder,UI.ThemeSupport.ColorUsage.Background)}willHide(){this.hideHighlight()}setBarHeight(e){this._barHeight=e}setTextBaseline(e){this._textBaseline=e}setTextPadding(e){this._textPadding=e}enableRuler(e){this._rulerEnabled=e}alwaysShowVerticalScroll(){this._chartViewport.alwaysShowVerticalScroll()}disableRangeSelection(){this._chartViewport.disableRangeSelection()}highlightEntry(e){if(this._highlightedEntryIndex===e)return;if(!this._dataProvider.entryColor(e))return;this._highlightedEntryIndex=e;this._updateElementPosition(this._highlightElement,this._highlightedEntryIndex);this.dispatchEventToListeners(PerfUI.FlameChart.Events.EntryHighlighted,e)}hideHighlight(){this._entryInfo.removeChildren();this._highlightedEntryIndex=-1;this._updateElementPosition(this._highlightElement,this._highlightedEntryIndex);this.dispatchEventToListeners(PerfUI.FlameChart.Events.EntryHighlighted,-1)}_resetCanvas(){const e=window.devicePixelRatio;const t=Math.round(this._offsetWidth*e);const i=Math.round(this._offsetHeight*e);this._canvas.width=t;this._canvas.height=i;this._canvas.style.width=`${t/e}px`;this._canvas.style.height=`${i/e}px`;if(this._useWebGL){this._canvasGL.width=t;this._canvasGL.height=i;this._canvasGL.style.width=`${t/e}px`;this._canvasGL.style.height=`${i/e}px`}}windowChanged(e,t,i){this._flameChartDelegate.windowChanged(e,t,i)}updateRangeSelection(e,t){this._flameChartDelegate.updateRangeSelection(e,t)}setSize(e,t){this._offsetWidth=e;this._offsetHeight=t}_startDragging(e){this.hideHighlight();this._maxDragOffset=0;this._dragStartX=e.pageX;this._dragStartY=e.pageY;return true}_dragging(e){const t=e.pageX-this._dragStartX;const i=e.pageY-this._dragStartY;this._maxDragOffset=Math.max(this._maxDragOffset,Math.sqrt(t*t+i*i))}_endDragging(e){this._updateHighlight()}_timelineData(){if(!this._dataProvider)return null;const e=this._dataProvider.timelineData();if(e!==this._rawTimelineData||e.entryStartTimes.length!==this._rawTimelineDataLength)this._processTimelineData(e);return this._rawTimelineData}_revealEntry(e){const t=this._timelineData();if(!t)return;const i=this._chartViewport.windowLeftTime();const s=this._chartViewport.windowRightTime();const n=t.entryStartTimes[e];const r=t.entryTotalTimes[e];const o=n+r;let a=Math.min(r,s-i);const l=t.entryLevels[e];this._chartViewport.setScrollOffset(this._levelToOffset(l),this._levelHeight(l));const h=30;const d=(s-i)/this._offsetWidth;a=Math.max(a,d*h);if(i>o){const e=i-o+a;this.windowChanged(i-e,s-e,true)}else if(s<n){const e=n-s+a;this.windowChanged(i+e,s+e,true)}}setWindowTimes(e,t,i){this._chartViewport.setWindowTimes(e,t,i);this._updateHighlight()}_onMouseMove(e){this._lastMouseOffsetX=e.offsetX;this._lastMouseOffsetY=e.offsetY;if(!this._enabled())return;if(this._chartViewport.isDragging())return;if(this._coordinatesToGroupIndex(e.offsetX,e.offsetY,true)>=0){this.hideHighlight();this._viewportElement.style.cursor="pointer";return}this._updateHighlight()}_updateHighlight(){const e=this._coordinatesToEntryIndex(this._lastMouseOffsetX,this._lastMouseOffsetY);if(e===-1){this.hideHighlight();const e=this._coordinatesToGroupIndex(this._lastMouseOffsetX,this._lastMouseOffsetY,false);if(e>=0&&this._rawTimelineData.groups[e].selectable)this._viewportElement.style.cursor="pointer";else this._viewportElement.style.cursor="default";return}if(this._chartViewport.isDragging())return;this._updatePopover(e);this._viewportElement.style.cursor=this._dataProvider.canJumpToEntry(e)?"pointer":"default";this.highlightEntry(e)}_onMouseOut(){this._lastMouseOffsetX=-1;this._lastMouseOffsetY=-1;this.hideHighlight()}_updatePopover(e){if(e===this._highlightedEntryIndex){this._updatePopoverOffset();return}this._entryInfo.removeChildren();const t=this._dataProvider.prepareHighlightedEntryInfo(e);if(t){this._entryInfo.appendChild(t);this._updatePopoverOffset()}}_updatePopoverOffset(){const e=this._lastMouseOffsetX;const t=this._lastMouseOffsetY;const i=this._entryInfo.parentElement.clientWidth;const s=this._entryInfo.parentElement.clientHeight;const n=this._entryInfo.clientWidth;const r=this._entryInfo.clientHeight;const o=10;const a=6;let l;let h;for(let d=0;d<4;++d){const c=d&2?-o-n:o;const _=d&1?-a-r:a;l=Number.constrain(e+c,0,i-n);h=Number.constrain(t+_,0,s-r);if(l>=e||e>=l+n||h>=t||t>=h+r)break}this._entryInfo.style.left=l+"px";this._entryInfo.style.top=h+"px"}_onClick(e){this.focus();const t=5;if(this._maxDragOffset>t)return;this._selectGroup(this._coordinatesToGroupIndex(e.offsetX,e.offsetY,false));this._toggleGroupExpand(this._coordinatesToGroupIndex(e.offsetX,e.offsetY,true));const i=this._timelineData();if(e.shiftKey&&this._highlightedEntryIndex!==-1&&i){const e=i.entryStartTimes[this._highlightedEntryIndex];const t=e+i.entryTotalTimes[this._highlightedEntryIndex];this._chartViewport.setRangeSelection(e,t)}else{this._chartViewport.onClick(e);this.dispatchEventToListeners(PerfUI.FlameChart.Events.EntrySelected,this._highlightedEntryIndex)}}_selectGroup(e){if(e<0||this._selectedGroup===e)return;const t=this._rawTimelineData.groups;this._keyboardFocusedGroup=e;if(!t[e].selectable){this._deselectAllGroups()}else{this._selectedGroup=e;this._flameChartDelegate.updateSelectedGroup(this,t[e]);this._resetCanvas();this._draw()}}_deselectAllGroups(){this._selectedGroup=-1;this._flameChartDelegate.updateSelectedGroup(this,null);this._resetCanvas();this._draw()}_deselectAllEntries(){this._selectedEntryIndex=-1;this._resetCanvas();this._draw()}_isGroupFocused(e){return e===this._selectedGroup||e===this._keyboardFocusedGroup}_toggleGroupExpand(e){if(e<0||!this._isGroupCollapsible(e))return;this._expandGroup(e,!this._rawTimelineData.groups[e].expanded)}_expandGroup(e,t=true){if(e<0||!this._isGroupCollapsible(e))return;const i=this._rawTimelineData.groups;const s=i[e];s.expanded=t;this._groupExpansionState[s.name]=s.expanded;if(this._groupExpansionSetting)this._groupExpansionSetting.set(this._groupExpansionState);this._updateLevelPositions();this._updateHighlight();if(!s.expanded){const t=this._timelineData();const n=t.entryLevels[this._selectedEntryIndex];if(this._selectedEntryIndex>=0&&n>=s.startLevel&&(e>=i.length-1||i[e+1].startLevel>n))this._selectedEntryIndex=-1}this._updateHeight();this._resetCanvas();this._draw()}_onKeyDown(e){if(!UI.KeyboardShortcut.hasNoModifiers(e)||!this._timelineData())return;const t=this._handleSelectionNavigation(e);if(!t&&this._rawTimelineData&&this._rawTimelineData.groups)this._handleKeyboardGroupNavigation(e)}_handleKeyboardGroupNavigation(e){let t=false;let i=false;if(e.code==="ArrowUp"){t=this._selectPreviousGroup()}else if(e.code==="ArrowDown"){t=this._selectNextGroup()}else if(e.code==="ArrowLeft"){if(this._keyboardFocusedGroup>=0){this._expandGroup(this._keyboardFocusedGroup,false);t=true}}else if(e.code==="ArrowRight"){if(this._keyboardFocusedGroup>=0){this._expandGroup(this._keyboardFocusedGroup,true);this._selectFirstChild();t=true}}else if(isEnterKey(e)){i=this._selectFirstEntryInCurrentGroup();t=i}if(t&&!i)this._deselectAllEntries();if(t)e.consume(true)}_selectFirstEntryInCurrentGroup(){const e=this._rawTimelineData.groups;if(this._keyboardFocusedGroup<0)return false;const t=e[this._keyboardFocusedGroup];const i=t.startLevel;if(i<0)return false;if(this._keyboardFocusedGroup<e.length-1&&e[this._keyboardFocusedGroup+1].startLevel===i)return false;const s=this._timelineLevels[i][0];this._expandGroup(this._keyboardFocusedGroup,true);this.setSelectedEntry(s);return true}_selectPreviousGroup(){if(this._keyboardFocusedGroup<=0)return false;const e=this._getGroupIndexToSelect(-1);this._selectGroup(e);return true}_selectNextGroup(){if(this._keyboardFocusedGroup>=this._rawTimelineData.groups.length-1)return false;const e=this._getGroupIndexToSelect(1);this._selectGroup(e);return true}_getGroupIndexToSelect(e){const t=this._rawTimelineData.groups;let i=this._keyboardFocusedGroup;let s,n;do{i+=e;s=this._rawTimelineData.groups[i].name;n=this._keyboardFocusedGroup!==-1&&t[i].style.nestingLevel>t[this._keyboardFocusedGroup].style.nestingLevel}while(i>0&&i<t.length-1&&(!s||n));return i}_selectFirstChild(){const e=this._rawTimelineData.groups;if(this._keyboardFocusedGroup<0||this._keyboardFocusedGroup>=e.length-1)return;const t=this._keyboardFocusedGroup+1;if(e[t].style.nestingLevel>e[this._keyboardFocusedGroup].style.nestingLevel){this._selectGroup(t);this._expandGroup(t,true)}}_handleSelectionNavigation(e){if(this._selectedEntryIndex===-1)return false;const t=this._timelineData();if(!t)return false;function i(e,i){return e-t.entryStartTimes[i]}function s(e,i){const s=t.entryStartTimes[e];const n=t.entryStartTimes[i];const r=s+t.entryTotalTimes[e];const o=n+t.entryTotalTimes[i];return s<o&&n<r}const n=UI.KeyboardShortcut.Keys;if(e.keyCode===n.Left.code||e.keyCode===n.Right.code){const i=t.entryLevels[this._selectedEntryIndex];const s=this._timelineLevels[i];let r=s.lowerBound(this._selectedEntryIndex);r+=e.keyCode===n.Left.code?-1:1;e.consume(true);if(r>=0&&r<s.length)this.dispatchEventToListeners(PerfUI.FlameChart.Events.EntrySelected,s[r]);return true}if(e.keyCode===n.Up.code||e.keyCode===n.Down.code){let r=t.entryLevels[this._selectedEntryIndex];r+=e.keyCode===n.Up.code?-1:1;if(r<0||r>=this._timelineLevels.length){this._deselectAllEntries();e.consume(true);return true}const o=t.entryStartTimes[this._selectedEntryIndex]+t.entryTotalTimes[this._selectedEntryIndex]/2;const a=this._timelineLevels[r];let l=a.upperBound(o,i)-1;if(!s(this._selectedEntryIndex,a[l])){++l;if(l>=a.length||!s(this._selectedEntryIndex,a[l])){if(e.code==="ArrowDown")return false;this._deselectAllEntries();e.consume(true);return true}}e.consume(true);this.dispatchEventToListeners(PerfUI.FlameChart.Events.EntrySelected,a[l]);return true}return false}_coordinatesToEntryIndex(e,t){if(e<0||t<0)return-1;const i=this._timelineData();if(!i)return-1;t+=this._chartViewport.scrollOffset();const s=this._visibleLevelOffsets.upperBound(t)-1;if(s<0||!this._visibleLevels[s])return-1;const n=t-this._visibleLevelOffsets[s];if(n>this._levelHeight(s))return-1;for(const[t,n]of this._markerPositions){if(i.entryLevels[t]!==s)continue;if(n.x<=e&&e<n.x+n.width)return t}const r=i.entryStartTimes;const o=this._timelineLevels[s];if(!o||!o.length)return-1;const a=this._chartViewport.pixelToTime(e);const l=Math.max(o.upperBound(a,(e,t)=>e-r[t])-1,0);function h(t){if(t===undefined)return false;const s=r[t];const n=i.entryTotalTimes[t];const o=this._chartViewport.timeToPosition(s);const a=this._chartViewport.timeToPosition(s+n);const l=3;return o-l<e&&e<a+l}let d=o[l];if(h.call(this,d))return d;d=o[l+1];if(h.call(this,d))return d;return-1}_coordinatesToGroupIndex(e,t,i){if(e<0||t<0)return-1;t+=this._chartViewport.scrollOffset();const s=this._rawTimelineData.groups||[];const n=this._groupOffsets.upperBound(t)-1;if(n<0||n>=s.length)return-1;const r=i?s[n].style.height:this._groupOffsets[n+1]-this._groupOffsets[n];if(t-this._groupOffsets[n]>=r)return-1;if(!i)return n;const o=this._canvas.getContext("2d");o.save();o.font=s[n].style.font;const a=this._headerLeftPadding+this._labelWidthForGroup(o,s[n]);o.restore();if(e>a)return-1;return n}_markerIndexAtPosition(e){const t=this._timelineData().markers;if(!t)return-1;const i=4;const s=this._chartViewport.pixelToTime(e);const n=this._chartViewport.pixelToTime(e-i);const r=this._chartViewport.pixelToTime(e+i);const o=this._markerIndexBeforeTime(n);let a=-1;let l=Infinity;for(let e=o;e<t.length&&t[e].startTime()<r;e++){const i=Math.abs(t[e].startTime()-s);if(i<l){a=e;l=i}}return a}_markerIndexBeforeTime(e){return this._timelineData().markers.lowerBound(e,(e,t)=>e-t.startTime())}_draw(){const e=this._timelineData();if(!e)return;const t=this._offsetWidth;const i=this._offsetHeight;const s=this._canvas.getContext("2d");s.save();const n=window.devicePixelRatio;const r=this._chartViewport.scrollOffset();s.scale(n,n);s.fillStyle="rgba(0, 0, 0, 0)";s.fillRect(0,0,t,i);s.translate(0,-r);const o="11px "+Host.fontFamily();s.font=o;const a=e.entryTotalTimes;const l=e.entryStartTimes;const h=e.entryLevels;const d=this._chartViewport.timeToPixel();const c=[];const _=[];const u=this._textPadding;const f=2*u+UI.measureTextWidth(s,"…");const m=this._chartViewport.pixelToTimeOffset(f);const p=Math.max(this._visibleLevelOffsets.upperBound(r)-1,0);this._markerPositions.clear();const g=new Map;for(let e=p;e<this._dataProvider.maxStackDepth();++e){if(this._levelToOffset(e)>r+i)break;if(!this._visibleLevels[e])continue;const t=this._timelineLevels[e];const s=t.lowerBound(this._chartViewport.windowRightTime(),(e,t)=>e-l[t])-1;let n=Infinity;for(let e=s;e>=0;--e){const i=t[e];const s=a[i];if(isNaN(s)){_.push(i);continue}if(s>=m||this._forceDecorationCache[i])c.push(i);const r=l[i];const o=r+s;if(o<=this._chartViewport.windowLeftTime())break;if(this._useWebGL)continue;const h=this._timeToPositionClipped(r);if(h>=n)continue;n=h;const d=this._entryColorsCache[i];let u=g.get(d);if(!u){u=[];g.set(d,u)}u.push(i)}}if(this._useWebGL){this._drawGL()}else{s.save();this._forEachGroupInViewport((e,i,n,r,o)=>{if(this._isGroupFocused(i)){s.fillStyle=this._selectedGroupBackroundColor;s.fillRect(0,e,t,o-n.style.padding)}});s.restore();for(const[e,t]of g){s.beginPath();for(let e=0;e<t.length;++e){const i=t[e];const n=a[i];if(isNaN(n))continue;const r=l[i];const o=this._timeToPositionClipped(r);const d=h[i];const c=this._levelHeight(d);const _=this._levelToOffset(d);const u=this._timeToPositionClipped(r+n);const f=Math.max(u-o,1);s.rect(o,_,f-.4,c-1)}s.fillStyle=e;s.fill()}}s.textBaseline="alphabetic";s.beginPath();let v=-1;let w=-Infinity;for(let e=_.length-1;e>=0;--e){const t=_[e];const i=this._dataProvider.entryTitle(t);if(!i)continue;const n=l[t];const r=h[t];if(v!==r)w=-Infinity;const o=Math.max(this._chartViewport.timeToPosition(n),w);const a=this._levelToOffset(r);const d=this._levelHeight(r);const c=4;const u=Math.ceil(UI.measureTextWidth(s,i))+2*c;w=o+u+1;v=r;this._markerPositions.set(t,{x:o,width:u});s.fillStyle=this._dataProvider.entryColor(t);s.fillRect(o,a,u,d-1);s.fillStyle="white";s.fillText(i,o+c,a+d-this._textBaseline)}s.strokeStyle="rgba(0, 0, 0, 0.2)";s.stroke();for(let e=0;e<c.length;++e){const i=c[e];const n=l[i];const r=this._timeToPositionClipped(n);const _=Math.min(this._timeToPositionClipped(n+a[i]),t)+1;const f=_-r;const m=h[i];const p=this._levelToOffset(m);let g=this._dataProvider.entryTitle(i);if(g&&g.length){s.font=this._dataProvider.entryFont(i)||o;g=UI.trimTextMiddle(s,g,f-2*u)}const v=this._chartViewport.timeToPosition(n);const w=this._levelHeight(m);if(this._dataProvider.decorateEntry(i,s,g,r,p,f,w,v,d))continue;if(!g||!g.length)continue;s.fillStyle=this._dataProvider.textColor(i);s.fillText(g,r+u,p+w-this._textBaseline)}s.restore();this._drawGroupHeaders(t,i);this._drawFlowEvents(s,t,i);this._drawMarkers();const y=PerfUI.TimelineGrid.calculateGridOffsets(this);PerfUI.TimelineGrid.drawCanvasGrid(s,y);if(this._rulerEnabled){PerfUI.TimelineGrid.drawCanvasHeaders(s,y,e=>this.formatValue(e,y.precision),3,PerfUI.FlameChart.HeaderHeight)}this._updateElementPosition(this._highlightElement,this._highlightedEntryIndex);this._updateElementPosition(this._selectedElement,this._selectedEntryIndex);this._updateMarkerHighlight()}_initWebGL(){const e=this._canvasGL.getContext("webgl");if(!e){console.error("Failed to obtain WebGL context.");this._useWebGL=false;return}const t=`\n      attribute vec2 aVertexPosition;\n      attribute float aVertexColor;\n\n      uniform vec2 uScalingFactor;\n      uniform vec2 uShiftVector;\n\n      varying mediump vec2 vPalettePosition;\n\n      void main() {\n        vec2 shiftedPosition = aVertexPosition - uShiftVector;\n        gl_Position = vec4(shiftedPosition * uScalingFactor + vec2(-1.0, 1.0), 0.0, 1.0);\n        vPalettePosition = vec2(aVertexColor, 0.5);\n      }`;const i=`\n      varying mediump vec2 vPalettePosition;\n      uniform sampler2D uSampler;\n\n      void main() {\n        gl_FragColor = texture2D(uSampler, vPalettePosition);\n      }`;function s(e,t,i){const s=e.createShader(t);e.shaderSource(s,i);e.compileShader(s);if(e.getShaderParameter(s,e.COMPILE_STATUS))return s;console.error("Shader compile error: "+e.getShaderInfoLog(s));e.deleteShader(s);return null}const n=s(e,e.VERTEX_SHADER,t);const r=s(e,e.FRAGMENT_SHADER,i);const o=e.createProgram();e.attachShader(o,n);e.attachShader(o,r);e.linkProgram(o);if(e.getProgramParameter(o,e.LINK_STATUS)){this._shaderProgram=o;e.useProgram(o)}else{console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(o));this._shaderProgram=null}this._vertexBuffer=e.createBuffer();this._colorBuffer=e.createBuffer();this._uScalingFactor=e.getUniformLocation(o,"uScalingFactor");this._uShiftVector=e.getUniformLocation(o,"uShiftVector");const a=e.getUniformLocation(o,"uSampler");e.uniform1i(a,0);this._aVertexPosition=e.getAttribLocation(this._shaderProgram,"aVertexPosition");this._aVertexColor=e.getAttribLocation(this._shaderProgram,"aVertexColor");e.enableVertexAttribArray(this._aVertexPosition);e.enableVertexAttribArray(this._aVertexColor)}_setupGLGeometry(){const e=this._canvasGL.getContext("webgl");if(!e)return;const t=this._timelineData();if(!t)return;const i=t.entryTotalTimes;const s=t.entryStartTimes;const n=t.entryLevels;const r=6;const o=new Float32Array(i.length*r*2);let a=new Uint8Array(i.length*r);let l=0;const h=new Map;const d=[];const c=new Array(this._visibleLevels.length);const _=this._rawTimelineData.groups||[];this._forEachGroup((e,t,i)=>{if(i.style.useFirstLineForOverview||!this._isGroupCollapsible(t)||i.expanded)return;let s=t+1;while(s<_.length&&_[s].style.nestingLevel>i.style.nestingLevel)++s;const n=s<_.length?_[s].startLevel:this._dataProvider.maxStackDepth();for(let t=i.startLevel;t<n;++t)c[t]=e});for(let e=0;e<i.length;++e){const t=n[e];const _=c[t];if(!this._visibleLevels[t]&&!_)continue;const u=this._entryColorsCache[e];if(!u)continue;let f=h.get(u);if(f===undefined){const e=Common.Color.parse(u).canonicalRGBA();e[3]=Math.round(e[3]*255);f=d.length/4;d.push(...e);if(f===256)a=new Uint16Array(a);h.set(u,f)}for(let e=0;e<r;++e)a[l+e]=f;const m=l*2;const p=s[e]-this._minimumBoundary;const g=p+i[e];const v=_||this._levelToOffset(t);const w=v+this._levelHeight(t)-1;o[m+0]=p;o[m+1]=v;o[m+2]=g;o[m+3]=v;o[m+4]=p;o[m+5]=w;o[m+6]=p;o[m+7]=w;o[m+8]=g;o[m+9]=v;o[m+10]=g;o[m+11]=w;l+=r}this._vertexCount=l;const u=e.createTexture();e.bindTexture(e.TEXTURE_2D,u);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.activeTexture(e.TEXTURE0);const f=d.length/4;const m=f>=256;const p=!m?256:Math.min(1<<16,e.getParameter(e.MAX_TEXTURE_SIZE));console.assert(f<=p,"Too many colors");const g=1;const v=m?e.UNSIGNED_SHORT:e.UNSIGNED_BYTE;if(m){const e=(1<<16)/p;for(let t=0;t<l;++t)a[t]*=e}const w=new Uint8Array(p*4);w.set(d);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,p,g,0,e.RGBA,e.UNSIGNED_BYTE,w);e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW);e.vertexAttribPointer(this._aVertexPosition,2,e.FLOAT,false,0,0);e.bindBuffer(e.ARRAY_BUFFER,this._colorBuffer);e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW);e.vertexAttribPointer(this._aVertexColor,1,v,true,0,0)}_drawGL(){const e=this._canvasGL.getContext("webgl");if(!e)return;const t=this._timelineData();if(!t)return;if(!this._prevTimelineData||t.entryTotalTimes!==this._prevTimelineData.entryTotalTimes){this._prevTimelineData=t;this._setupGLGeometry()}e.viewport(0,0,this._canvasGL.width,this._canvasGL.height);if(!this._vertexCount)return;const i=[2/this.boundarySpan(),-2*window.devicePixelRatio/this._canvasGL.height];const s=[this.minimumBoundary()-this.zeroTime(),this._chartViewport.scrollOffset()];e.uniform2fv(this._uScalingFactor,i);e.uniform2fv(this._uShiftVector,s);e.drawArrays(e.TRIANGLES,0,this._vertexCount)}_drawGroupHeaders(e,t){const i=this._canvas.getContext("2d");const s=this._chartViewport.scrollOffset();const n=window.devicePixelRatio;const r=this._rawTimelineData.groups||[];if(!r.length)return;const o=this._groupOffsets;const a=Array.prototype.peekLast.call(o);const l=UI.ThemeSupport.ColorUsage;i.save();i.scale(n,n);i.translate(0,-s);const h="11px "+Host.fontFamily();i.font=h;i.fillStyle=UI.themeSupport.patchColorText("#fff",l.Background);this._forEachGroupInViewport((t,s,n)=>{const r=n.style.padding;if(r<5)return;i.fillRect(0,t-r+2,e,r-4)});if(r.length&&a<s+t)i.fillRect(0,a+2,e,s+t-a);i.strokeStyle=UI.themeSupport.patchColorText("#eee",l.Background);i.beginPath();this._forEachGroupInViewport((e,t,i,s)=>{if(s||i.style.padding<4)return;d(e-2.5)});d(a+1.5);i.stroke();this._forEachGroupInViewport((t,s,n)=>{if(n.style.useFirstLineForOverview)return;if(!this._isGroupCollapsible(s)||n.expanded){if(!n.style.shareHeaderLine&&this._isGroupFocused(s)){i.fillStyle=n.style.backgroundColor;i.fillRect(0,t,e,n.style.height)}return}if(this._useWebGL)return;let o=s+1;while(o<r.length&&r[o].style.nestingLevel>n.style.nestingLevel)o++;const a=o<r.length?r[o].startLevel:this._dataProvider.maxStackDepth();this._drawCollapsedOverviewForGroup(n,t,a)});i.save();this._forEachGroupInViewport((e,t,s)=>{i.font=s.style.font;if(this._isGroupCollapsible(t)&&!s.expanded||s.style.shareHeaderLine){const n=this._labelWidthForGroup(i,s)+2;if(this._isGroupFocused(t))i.fillStyle=this._selectedGroupBackroundColor;else i.fillStyle=Common.Color.parse(s.style.backgroundColor).setAlpha(.8).asString(null);i.fillRect(this._headerLeftPadding-this._headerLabelXPadding,e+this._headerLabelYPadding,n,s.style.height-2*this._headerLabelYPadding)}i.fillStyle=s.style.color;i.fillText(s.name,Math.floor(this._expansionArrowIndent*(s.style.nestingLevel+1)+this._arrowSide),e+s.style.height-this._textBaseline)});i.restore();i.fillStyle=UI.themeSupport.patchColorText("#6e6e6e",l.Foreground);i.beginPath();this._forEachGroupInViewport((e,t,i)=>{if(this._isGroupCollapsible(t)){c.call(this,this._expansionArrowIndent*(i.style.nestingLevel+1),e+i.style.height-this._textBaseline-this._arrowSide/2,!!i.expanded)}});i.fill();i.strokeStyle=UI.themeSupport.patchColorText("#ddd",l.Background);i.beginPath();i.stroke();this._forEachGroupInViewport((e,t,s,n,r)=>{if(this._isGroupFocused(t)){const t=2;const n=10;i.fillStyle=this._selectedGroupBorderColor;i.fillRect(0,e-t,t,r-s.style.padding+2*t);i.fillRect(0,e-t,n,t);i.fillRect(0,e+r-s.style.padding,n,t)}});i.restore();function d(t){i.moveTo(0,t);i.lineTo(e,t)}function c(e,t,s){const n=this._arrowSide*Math.sqrt(3)/2;const r=Math.round(n/2);i.save();i.translate(e,t);i.rotate(s?Math.PI/2:0);i.moveTo(-r,-this._arrowSide/2);i.lineTo(-r,this._arrowSide/2);i.lineTo(n-r,0);i.restore()}}_forEachGroup(e){const t=this._rawTimelineData.groups||[];if(!t.length)return;const i=this._groupOffsets;const s=[{nestingLevel:-1,visible:true}];for(let n=0;n<t.length;++n){const r=i[n];const o=t[n];let a=true;while(s.peekLast().nestingLevel>=o.style.nestingLevel){s.pop();a=false}const l=s.peekLast().visible;const h=l&&(!this._isGroupCollapsible(n)||o.expanded);s.push({nestingLevel:o.style.nestingLevel,visible:h});const d=n===t.length-1?i[n+1]+o.style.padding:i[n+1];if(!l)continue;e(r,n,o,a,d-r)}}_forEachGroupInViewport(e){const t=this._chartViewport.scrollOffset();this._forEachGroup((i,s,n,r,o)=>{if(i-n.style.padding>t+this._offsetHeight)return;if(i+o<t)return;e(i,s,n,r,o)})}_labelWidthForGroup(e,t){return UI.measureTextWidth(e,t.name)+this._expansionArrowIndent*(t.style.nestingLevel+1)+2*this._headerLabelXPadding}_drawCollapsedOverviewForGroup(e,t,i){const s=new Common.SegmentedRange(u);const n=this._chartViewport.windowLeftTime();const r=this._chartViewport.windowRightTime();const o=this._canvas.getContext("2d");const a=e.style.height;const l=this._rawTimelineData.entryStartTimes;const h=this._rawTimelineData.entryTotalTimes;const d=this._chartViewport.timeToPixel();for(let c=e.startLevel;c<i;++c){const i=this._timelineLevels[c];const _=i.lowerBound(r,(e,t)=>e-l[t])-1;let u=Infinity;for(let r=_;r>=0;--r){const c=i[r];const _=l[c];const f=this._timeToPositionClipped(_);const m=_+h[c];if(isNaN(m)||f>=u)continue;if(m<=n)break;u=f;const p=this._entryColorsCache[c];const g=this._timeToPositionClipped(m);if(e.style.useDecoratorsForOverview&&this._dataProvider.forceDecoration(c)){const e=this._chartViewport.timeToPosition(_);const i=g-f;o.beginPath();o.fillStyle=p;o.fillRect(f,t,i,a-1);this._dataProvider.decorateEntry(c,o,"",f,t,i,a,e,d);continue}s.append(new Common.Segment(f,g,p))}}const c=s.segments().slice().sort((e,t)=>e.data.localeCompare(t.data));let _;o.beginPath();for(let e=0;e<c.length;++e){const i=c[e];if(_!==c[e].data){o.fill();o.beginPath();_=c[e].data;o.fillStyle=_}o.rect(i.begin,t,i.end-i.begin,a)}o.fill();function u(e,t){return e.data===t.data&&e.end+.4>t.end?e:null}}_drawFlowEvents(e,t,i){e.save();const s=window.devicePixelRatio;const n=this._chartViewport.scrollOffset();const r=6;e.scale(s,s);e.translate(0,-n);e.fillStyle="#7f5050";e.strokeStyle="#7f5050";const o=this._timelineData();const a=o.flowStartTimes.lowerBound(this._chartViewport.windowRightTime());e.lineWidth=.5;for(let t=0;t<a;++t){if(!o.flowEndTimes[t]||o.flowEndTimes[t]<this._chartViewport.windowLeftTime())continue;const i=this._chartViewport.timeToPosition(o.flowStartTimes[t]);const s=this._chartViewport.timeToPosition(o.flowEndTimes[t]);const n=o.flowStartLevels[t];const a=o.flowEndLevels[t];const l=this._levelToOffset(n)+this._levelHeight(n)/2;const h=this._levelToOffset(a)+this._levelHeight(a)/2;const d=Math.min((s-i)/4,40);const c=o.flowEndTimes[t]-o.flowStartTimes[t];const _=(h-l)/10;const u=30;const f=c<1?l:u+Math.max(0,l+_*(t%u));const m=[];m.push({x:i,y:l});m.push({x:i+r,y:l});m.push({x:i+d+2*r,y:l});m.push({x:i+d,y:f});m.push({x:i+d*2,y:f});m.push({x:s-d*2,y:f});m.push({x:s-d,y:f});m.push({x:s-d-2*r,y:h});m.push({x:s-r,y:h});e.beginPath();e.moveTo(m[0].x,m[0].y);e.lineTo(m[1].x,m[1].y);e.bezierCurveTo(m[2].x,m[2].y,m[3].x,m[3].y,m[4].x,m[4].y);e.lineTo(m[5].x,m[5].y);e.bezierCurveTo(m[6].x,m[6].y,m[7].x,m[7].y,m[8].x,m[8].y);e.stroke();e.beginPath();e.arc(i,l,2,-Math.PI/2,Math.PI/2,false);e.fill();e.beginPath();e.moveTo(s,h);e.lineTo(s-r,h-3);e.lineTo(s-r,h+3);e.fill()}e.restore()}_drawMarkers(){const e=this._timelineData().markers;const t=this._markerIndexBeforeTime(this.minimumBoundary());const i=this.maximumBoundary();const s=this._chartViewport.timeToPixel();const n=this._canvas.getContext("2d");n.save();const r=window.devicePixelRatio;n.scale(r,r);n.translate(0,3);const o=PerfUI.FlameChart.HeaderHeight-1;for(let r=t;r<e.length;r++){const t=e[r].startTime();if(t>i)break;e[r].draw(n,this._chartViewport.timeToPosition(t),o,s)}n.restore()}_updateMarkerHighlight(){const e=this._markerHighlighElement;if(e.parentElement)e.remove();const t=this._highlightedMarkerIndex;if(t===-1)return;const i=this._timelineData().markers[t];const s=this._timeToPositionClipped(i.startTime());e.title=i.title();const n=e.style;n.left=s+"px";n.backgroundColor=i.color();this._viewportElement.appendChild(e)}_processTimelineData(e){if(!e){this._timelineLevels=null;this._visibleLevelOffsets=null;this._visibleLevels=null;this._groupOffsets=null;this._rawTimelineData=null;this._forceDecorationCache=null;this._entryColorsCache=null;this._rawTimelineDataLength=0;this._selectedGroup=-1;this._keyboardFocusedGroup=-1;this._flameChartDelegate.updateSelectedGroup(this,null);return}this._rawTimelineData=e;this._rawTimelineDataLength=e.entryStartTimes.length;this._forceDecorationCache=new Int8Array(this._rawTimelineDataLength);this._entryColorsCache=new Array(this._rawTimelineDataLength);for(let e=0;e<this._rawTimelineDataLength;++e){this._forceDecorationCache[e]=this._dataProvider.forceDecoration(e)?1:0;this._entryColorsCache[e]=this._dataProvider.entryColor(e)}const t=new Uint32Array(this._dataProvider.maxStackDepth()+1);for(let i=0;i<e.entryLevels.length;++i)++t[e.entryLevels[i]];const i=new Array(t.length);for(let e=0;e<i.length;++e){i[e]=new Uint32Array(t[e]);t[e]=0}for(let s=0;s<e.entryLevels.length;++s){const n=e.entryLevels[s];i[n][t[n]++]=s}this._timelineLevels=i;const s=this._rawTimelineData.groups||[];for(let e=0;e<s.length;++e){const t=this._groupExpansionState[s[e].name];if(t!==undefined)s[e].expanded=t}this._updateLevelPositions();this._updateHeight();this._selectedGroup=e.selectedGroup?s.indexOf(e.selectedGroup):-1;this._keyboardFocusedGroup=this._selectedGroup;this._flameChartDelegate.updateSelectedGroup(this,e.selectedGroup)}_updateLevelPositions(){const e=this._dataProvider.maxStackDepth();const t=this._rawTimelineData.groups||[];this._visibleLevelOffsets=new Uint32Array(e+1);this._visibleLevelHeights=new Uint32Array(e);this._visibleLevels=new Uint16Array(e);this._groupOffsets=new Uint32Array(t.length+1);let i=-1;let s=this._rulerEnabled?PerfUI.FlameChart.HeaderHeight+2:2;let n=true;const r=[{nestingLevel:-1,visible:true}];const o=Math.max(e,t.length?t.peekLast().startLevel+1:0);let a;for(a=0;a<o;++a){let o=true;let l;while(i<t.length-1&&a===t[i+1].startLevel){++i;l=t[i].style;let e=true;while(r.peekLast().nestingLevel>=l.nestingLevel){r.pop();e=false}const a=i>=0&&this._isGroupCollapsible(i)?t[i].expanded:true;o=r.peekLast().visible;n=a&&o;r.push({nestingLevel:l.nestingLevel,visible:n});if(o)s+=e?0:l.padding;this._groupOffsets[i]=s;if(o&&!l.shareHeaderLine)s+=l.height}const h=i>=0&&a===t[i].startLevel;const d=o&&(n||h&&t[i].style.useFirstLineForOverview);if(a<e){let e;if(i>=0){const s=t[i];const n=s.style;e=h&&!n.shareHeaderLine||n.collapsible&&!s.expanded?n.height:n.itemsHeight||this._barHeight}else{e=this._barHeight}this._visibleLevels[a]=d;this._visibleLevelOffsets[a]=s;this._visibleLevelHeights[a]=e}if(d||o&&l&&l.shareHeaderLine&&h)s+=this._visibleLevelHeights[a]}if(i>=0)this._groupOffsets[i+1]=s;this._visibleLevelOffsets[a]=s;if(this._useWebGL)this._setupGLGeometry()}_isGroupCollapsible(e){const t=this._rawTimelineData.groups||[];const i=t[e].style;if(!i.shareHeaderLine||!i.collapsible)return!!i.collapsible;const s=e+1>=t.length;if(!s&&t[e+1].style.nestingLevel>i.nestingLevel)return true;const n=s?this._dataProvider.maxStackDepth():t[e+1].startLevel;if(n!==t[e].startLevel+1)return true;return i.height!==i.itemsHeight}setSelectedEntry(e){if(this._selectedEntryIndex===e)return;if(e!==-1)this._chartViewport.hideRangeSelection();this._selectedEntryIndex=e;this._revealEntry(e);this._updateElementPosition(this._selectedElement,this._selectedEntryIndex)}_updateElementPosition(e,t){const i=2;e.classList.add("hidden");if(t===-1)return;const s=this._timelineData();const n=s.entryStartTimes[t];const r=s.entryTotalTimes[t];let o=0;let a=0;let l=true;if(Number.isNaN(r)){const e=this._markerPositions.get(t);if(e){o=e.x;a=e.width}else{l=false}}else{o=this._chartViewport.timeToPosition(n);a=r*this._chartViewport.timeToPixel()}if(o+a<=0||o>=this._offsetWidth)return;const h=o+a/2;a=Math.max(a,i);o=h-a/2;const d=s.entryLevels[t];const c=this._levelToOffset(d)-this._chartViewport.scrollOffset();const _=this._levelHeight(d);const u=e.style;u.left=o+"px";u.top=c+"px";u.width=a+"px";u.height=_-1+"px";e.classList.toggle("hidden",!l);this._viewportElement.appendChild(e)}_timeToPositionClipped(e){return Number.constrain(this._chartViewport.timeToPosition(e),0,this._offsetWidth)}_levelToOffset(e){return this._visibleLevelOffsets[e]}_levelHeight(e){return this._visibleLevelHeights[e]}_updateBoundaries(){this._totalTime=this._dataProvider.totalTime();this._minimumBoundary=this._dataProvider.minimumBoundary();this._chartViewport.setBoundaries(this._minimumBoundary,this._totalTime)}_updateHeight(){const e=this._levelToOffset(this._dataProvider.maxStackDepth())+2;this._chartViewport.setContentHeight(e)}onResize(){this.scheduleUpdate()}update(){if(!this._timelineData())return;this._resetCanvas();this._updateHeight();this._updateBoundaries();this._draw();if(!this._chartViewport.isDragging())this._updateHighlight()}reset(){this._chartViewport.reset();this._rawTimelineData=null;this._rawTimelineDataLength=0;this._highlightedMarkerIndex=-1;this._highlightedEntryIndex=-1;this._selectedEntryIndex=-1;this._textWidth=new Map;this._chartViewport.scheduleUpdate()}scheduleUpdate(){this._chartViewport.scheduleUpdate()}_enabled(){return this._rawTimelineDataLength!==0}computePosition(e){return this._chartViewport.timeToPosition(e)}formatValue(e,t){return this._dataProvider.formatValue(e-this.zeroTime(),t)}maximumBoundary(){return this._chartViewport.windowRightTime()}minimumBoundary(){return this._chartViewport.windowLeftTime()}zeroTime(){return this._dataProvider.minimumBoundary()}boundarySpan(){return this.maximumBoundary()-this.minimumBoundary()}};PerfUI.FlameChart.HeaderHeight=15;PerfUI.FlameChart.MinimalTimeWindowMs=.5;PerfUI.FlameChartDataProvider=function(){};PerfUI.FlameChart.Group;PerfUI.FlameChart.GroupStyle;PerfUI.FlameChart.TimelineData=class{constructor(e,t,i,s){this.entryLevels=e;this.entryTotalTimes=t;this.entryStartTimes=i;this.groups=s;this.markers=[];this.flowStartTimes=[];this.flowStartLevels=[];this.flowEndTimes=[];this.flowEndLevels=[];this.selectedGroup=null}};PerfUI.FlameChartDataProvider.prototype={minimumBoundary(){},totalTime(){},formatValue(e,t){},maxStackDepth(){},timelineData(){},prepareHighlightedEntryInfo(e){},canJumpToEntry(e){},entryTitle(e){},entryFont(e){},entryColor(e){},decorateEntry(e,t,i,s,n,r,o,a,l){},forceDecoration(e){},textColor(e){}};PerfUI.FlameChartMarker=function(){};PerfUI.FlameChartMarker.prototype={startTime(){},color(){},title(){},draw(e,t,i,s){}};PerfUI.FlameChart.Events={EntrySelected:Symbol("EntrySelected"),EntryHighlighted:Symbol("EntryHighlighted")};PerfUI.FlameChart.Colors={SelectedGroupBackground:"hsl(215, 85%, 98%)",SelectedGroupBorder:"hsl(216, 68%, 54%)"};PerfUI.GCActionDelegate=class{handleAction(e,t){for(const e of SDK.targetManager.models(SDK.HeapProfilerModel))e.collectGarbage();return true}};PerfUI.LineLevelProfile={};PerfUI.LineLevelProfile.Performance=class{constructor(){this._helper=new PerfUI.LineLevelProfile._Helper("performance")}reset(){this._helper.reset()}_appendLegacyCPUProfile(e){const t=e.target();const i=[e.profileHead];const s=(e.profileEndTime-e.profileStartTime)/e.totalHitCount;while(i.length){const e=i.pop().children;for(let n=0;n<e.length;++n){const r=e[n];i.push(r);if(!r.url||!r.positionTicks)continue;for(let e=0;e<r.positionTicks.length;++e){const i=r.positionTicks[e];const n=i.line;const o=i.ticks*s;this._helper.addLineData(t,r.url,n,o)}}}}appendCPUProfile(e){if(!e.lines){this._appendLegacyCPUProfile(e);this._helper.scheduleUpdate();return}const t=e.target();for(let i=1;i<e.samples.length;++i){const s=e.lines[i];if(!s)continue;const n=e.nodeByIndex(i);const r=n.scriptId||n.url;if(!r)continue;const o=e.timestamps[i]-e.timestamps[i-1];this._helper.addLineData(t,r,s,o)}this._helper.scheduleUpdate()}};PerfUI.LineLevelProfile.Memory=class{constructor(){this._helper=new PerfUI.LineLevelProfile._Helper("memory")}reset(){this._helper.reset()}appendHeapProfile(e,t){const i=this._helper;s(e.head);i.scheduleUpdate();function s(e){e.children.forEach(s);if(!e.selfSize)return;const n=Number(e.callFrame.scriptId)||e.callFrame.url;if(!n)return;const r=e.callFrame.lineNumber+1;i.addLineData(t,n,r,e.selfSize)}}};PerfUI.LineLevelProfile._Helper=class{constructor(e){this._type=e;this._locationPool=new Bindings.LiveLocationPool;this._updateTimer=null;this.reset()}reset(){this._lineData=new Map;this.scheduleUpdate()}addLineData(e,t,i,s){let n=this._lineData.get(e);if(!n){n=new Map;this._lineData.set(e,n)}let r=n.get(t);if(!r){r=new Map;n.set(t,r)}r.set(i,(r.get(i)||0)+s)}scheduleUpdate(){if(this._updateTimer)return;this._updateTimer=setTimeout(()=>{this._updateTimer=null;this._doUpdate()},0)}_doUpdate(){this._locationPool.disposeAll();Workspace.workspace.uiSourceCodes().forEach(e=>e.removeDecorationsForType(this._type));for(const e of this._lineData){const t=e[0];const i=t?t.model(SDK.DebuggerModel):null;const s=e[1];for(const e of s){const t=e[0];const s=e[1];const n=!i&&typeof t==="string"?Workspace.workspace.uiSourceCodeForURL(t):null;if(!i&&!n)continue;for(const e of s){const s=e[0]-1;const r=e[1];if(n){n.addLineDecoration(s,this._type,r);continue}const o=typeof t==="string"?i.createRawLocationByURL(t,s,0):i.createRawLocationByScriptId(String(t),s,0);if(o)new PerfUI.LineLevelProfile.Presentation(o,this._type,r,this._locationPool)}}}}};PerfUI.LineLevelProfile.Presentation=class{constructor(e,t,i,s){this._type=t;this._time=i;this._uiLocation=null;Bindings.debuggerWorkspaceBinding.createLiveLocation(e,this.updateLocation.bind(this),s)}updateLocation(e){if(this._uiLocation)this._uiLocation.uiSourceCode.removeDecorationsForType(this._type);this._uiLocation=e.uiLocation();if(this._uiLocation)this._uiLocation.uiSourceCode.addLineDecoration(this._uiLocation.lineNumber,this._type,this._time)}};PerfUI.LineLevelProfile.LineDecorator=class{decorate(e,t,i){const s=`CodeMirror-gutter-${i}`;const n=e.decorationsForType(i);t.uninstallGutter(s);if(!n||!n.size)return;t.installGutter(s,false);for(const e of n){const n=e.data();const r=this._createElement(i,n);t.setGutterDecoration(e.range().startLine,s,r)}}_createElement(e,t){const i=createElementWithClass("div","text-editor-line-marker-text");if(e==="performance"){const e=Number.constrain(Math.log10(1+10*t)/5,.02,1);i.textContent=Common.UIString("%.1f",t);i.style.backgroundColor=`hsla(44, 100%, 50%, ${e.toFixed(3)})`;i.createChild("span","line-marker-units").textContent=ls`ms`}else{const e=Number.constrain(Math.log10(1+.002*t)/5,.02,1);i.style.backgroundColor=`hsla(217, 100%, 70%, ${e.toFixed(3)})`;t/=1e3;let s;let n;if(t>=1e3){s=ls`MB`;t/=1e3;n=t>=20?0:1}else{s=ls`KB`;n=0}i.textContent=Common.UIString(`%.${n}f`,t);i.createChild("span","line-marker-units").textContent=s}return i}};PerfUI.LiveHeapProfile=class{constructor(){this._running=false;this._sessionId=0;this._loadEventCallback=(()=>{});this._setting=Common.settings.moduleSetting("memoryLiveHeapProfile");this._setting.addChangeListener(e=>e.data?this._startProfiling():this._stopProfiling());if(this._setting.get())this._startProfiling()}run(){}modelAdded(e){e.startSampling(1e4)}modelRemoved(e){}async _startProfiling(){if(this._running)return;this._running=true;const e=this._sessionId;SDK.targetManager.observeModels(SDK.HeapProfilerModel,this);SDK.targetManager.addModelListener(SDK.ResourceTreeModel,SDK.ResourceTreeModel.Events.Load,this._loadEventFired,this);do{const t=SDK.targetManager.models(SDK.HeapProfilerModel);const i=await Promise.all(t.map(e=>e.getSamplingProfile()));if(e!==this._sessionId)break;const s=self.runtime.sharedInstance(PerfUI.LineLevelProfile.Memory);s.reset();for(let e=0;e<i.length;++e){if(i[e])s.appendHeapProfile(i[e],t[e].target())}await Promise.race([new Promise(e=>setTimeout(e,Host.isUnderTest()?10:5e3)),new Promise(e=>this._loadEventCallback=e)])}while(e===this._sessionId);SDK.targetManager.unobserveModels(SDK.HeapProfilerModel,this);SDK.targetManager.removeModelListener(SDK.ResourceTreeModel,SDK.ResourceTreeModel.Events.Load,this._loadEventFired,this);for(const e of SDK.targetManager.models(SDK.HeapProfilerModel))e.stopSampling();self.runtime.sharedInstance(PerfUI.LineLevelProfile.Memory).reset()}_stopProfiling(){if(!this._running)return;this._running=0;this._sessionId++}_loadEventFired(){this._loadEventCallback()}};PerfUI.uiLabelForNetworkPriority=function(e){return PerfUI._priorityUILabelMap().get(e)||""};PerfUI.uiLabelToNetworkPriority=function(e){if(!PerfUI._uiLabelToPriorityMapInstance){PerfUI._uiLabelToPriorityMapInstance=new Map;PerfUI._priorityUILabelMap().forEach((e,t)=>PerfUI._uiLabelToPriorityMapInstance.set(e,t))}return PerfUI._uiLabelToPriorityMapInstance.get(e)||""};PerfUI._priorityUILabelMap=function(){if(PerfUI._priorityUILabelMapInstance)return PerfUI._priorityUILabelMapInstance;const e=new Map;e.set(Protocol.Network.ResourcePriority.VeryLow,Common.UIString("Lowest"));e.set(Protocol.Network.ResourcePriority.Low,Common.UIString("Low"));e.set(Protocol.Network.ResourcePriority.Medium,Common.UIString("Medium"));e.set(Protocol.Network.ResourcePriority.High,Common.UIString("High"));e.set(Protocol.Network.ResourcePriority.VeryHigh,Common.UIString("Highest"));PerfUI._priorityUILabelMapInstance=e;return e};PerfUI.networkPriorityWeight=function(e){if(!PerfUI._networkPriorityWeights){const e=new Map;e.set(Protocol.Network.ResourcePriority.VeryLow,1);e.set(Protocol.Network.ResourcePriority.Low,2);e.set(Protocol.Network.ResourcePriority.Medium,3);e.set(Protocol.Network.ResourcePriority.High,4);e.set(Protocol.Network.ResourcePriority.VeryHigh,5);PerfUI._networkPriorityWeights=e}return PerfUI._networkPriorityWeights.get(e)||0};PerfUI.OverviewGrid=class{constructor(e){this.element=createElement("div");this.element.id=e+"-overview-container";this._grid=new PerfUI.TimelineGrid;this._grid.element.id=e+"-overview-grid";this._grid.setScrollTop(0);this.element.appendChild(this._grid.element);this._window=new PerfUI.OverviewGrid.Window(this.element,this._grid.dividersLabelBarElement)}clientWidth(){return this.element.clientWidth}updateDividers(e){this._grid.updateDividers(e)}addEventDividers(e){this._grid.addEventDividers(e)}removeEventDividers(){this._grid.removeEventDividers()}reset(){this._window.reset()}windowLeft(){return this._window.windowLeft}windowRight(){return this._window.windowRight}setWindow(e,t){this._window._setWindow(e,t)}addEventListener(e,t,i){return this._window.addEventListener(e,t,i)}setClickHandler(e){this._window.setClickHandler(e)}zoom(e,t){this._window._zoom(e,t)}setResizeEnabled(e){this._window.setEnabled(e)}};PerfUI.OverviewGrid.MinSelectableSize=14;PerfUI.OverviewGrid.WindowScrollSpeedFactor=.3;PerfUI.OverviewGrid.ResizerOffset=3.5;PerfUI.OverviewGrid.Window=class extends Common.Object{constructor(e,t){super();this._parentElement=e;UI.installDragHandle(this._parentElement,this._startWindowSelectorDragging.bind(this),this._windowSelectorDragging.bind(this),this._endWindowSelectorDragging.bind(this),"text",null);if(t){UI.installDragHandle(t,this._startWindowDragging.bind(this),this._windowDragging.bind(this),null,"-webkit-grabbing","-webkit-grab")}this._parentElement.addEventListener("mousewheel",this._onMouseWheel.bind(this),true);this._parentElement.addEventListener("dblclick",this._resizeWindowMaximum.bind(this),true);UI.appendStyle(this._parentElement,"perf_ui/overviewGrid.css");this._leftResizeElement=e.createChild("div","overview-grid-window-resizer");UI.installDragHandle(this._leftResizeElement,this._resizerElementStartDragging.bind(this),this._leftResizeElementDragging.bind(this),null,"ew-resize");this._rightResizeElement=e.createChild("div","overview-grid-window-resizer");UI.installDragHandle(this._rightResizeElement,this._resizerElementStartDragging.bind(this),this._rightResizeElementDragging.bind(this),null,"ew-resize");this._leftCurtainElement=e.createChild("div","window-curtain-left");this._rightCurtainElement=e.createChild("div","window-curtain-right");this.reset()}reset(){this.windowLeft=0;this.windowRight=1;this.setEnabled(true);this._updateCurtains()}setEnabled(e){this._enabled=e}setClickHandler(e){this._clickHandler=e}_resizerElementStartDragging(e){if(!this._enabled)return false;this._resizerParentOffsetLeft=e.pageX-e.offsetX-e.target.offsetLeft;e.stopPropagation();return true}_leftResizeElementDragging(e){this._resizeWindowLeft(e.pageX-this._resizerParentOffsetLeft);e.preventDefault()}_rightResizeElementDragging(e){this._resizeWindowRight(e.pageX-this._resizerParentOffsetLeft);e.preventDefault()}_startWindowSelectorDragging(e){if(!this._enabled)return false;this._offsetLeft=this._parentElement.totalOffsetLeft();const t=e.x-this._offsetLeft;this._overviewWindowSelector=new PerfUI.OverviewGrid.WindowSelector(this._parentElement,t);return true}_windowSelectorDragging(e){this._overviewWindowSelector._updatePosition(e.x-this._offsetLeft);e.preventDefault()}_endWindowSelectorDragging(e){const t=this._overviewWindowSelector._close(e.x-this._offsetLeft);delete this._overviewWindowSelector;const i=3;if(t.end-t.start<i){if(this._clickHandler&&this._clickHandler.call(null,e))return;const i=t.end;t.start=Math.max(0,i-PerfUI.OverviewGrid.MinSelectableSize/2);t.end=Math.min(this._parentElement.clientWidth,i+PerfUI.OverviewGrid.MinSelectableSize/2)}else if(t.end-t.start<PerfUI.OverviewGrid.MinSelectableSize){if(this._parentElement.clientWidth-t.end>PerfUI.OverviewGrid.MinSelectableSize)t.end=t.start+PerfUI.OverviewGrid.MinSelectableSize;else t.start=t.end-PerfUI.OverviewGrid.MinSelectableSize}this._setWindowPosition(t.start,t.end)}_startWindowDragging(e){this._dragStartPoint=e.pageX;this._dragStartLeft=this.windowLeft;this._dragStartRight=this.windowRight;e.stopPropagation();return true}_windowDragging(e){e.preventDefault();let t=(e.pageX-this._dragStartPoint)/this._parentElement.clientWidth;if(this._dragStartLeft+t<0)t=-this._dragStartLeft;if(this._dragStartRight+t>1)t=1-this._dragStartRight;this._setWindow(this._dragStartLeft+t,this._dragStartRight+t)}_resizeWindowLeft(e){if(e<10)e=0;else if(e>this._rightResizeElement.offsetLeft-4)e=this._rightResizeElement.offsetLeft-4;this._setWindowPosition(e,null)}_resizeWindowRight(e){if(e>this._parentElement.clientWidth-10)e=this._parentElement.clientWidth;else if(e<this._leftResizeElement.offsetLeft+PerfUI.OverviewGrid.MinSelectableSize)e=this._leftResizeElement.offsetLeft+PerfUI.OverviewGrid.MinSelectableSize;this._setWindowPosition(null,e)}_resizeWindowMaximum(){this._setWindowPosition(0,this._parentElement.clientWidth)}_setWindow(e,t){this.windowLeft=e;this.windowRight=t;this._updateCurtains();this.dispatchEventToListeners(PerfUI.OverviewGrid.Events.WindowChanged)}_updateCurtains(){let e=this.windowLeft;let t=this.windowRight;const i=t-e;const s=i*this._parentElement.clientWidth;const n=PerfUI.OverviewGrid.MinSelectableSize/2;if(s<n){const r=n/s;e=(this.windowRight+this.windowLeft-i*r)/2;t=(this.windowRight+this.windowLeft+i*r)/2}this._leftResizeElement.style.left=(100*e).toFixed(2)+"%";this._rightResizeElement.style.left=(100*t).toFixed(2)+"%";this._leftCurtainElement.style.width=(100*e).toFixed(2)+"%";this._rightCurtainElement.style.width=(100*(1-t)).toFixed(2)+"%"}_setWindowPosition(e,t){const i=this._parentElement.clientWidth;const s=typeof e==="number"?e/i:this.windowLeft;const n=typeof t==="number"?t/i:this.windowRight;this._setWindow(s,n)}_onMouseWheel(e){if(!this._enabled)return;if(typeof e.wheelDeltaY==="number"&&e.wheelDeltaY){const t=1.1;const i=1/120;const s=e.offsetX/e.target.clientWidth;this._zoom(Math.pow(t,-e.wheelDeltaY*i),s)}if(typeof e.wheelDeltaX==="number"&&e.wheelDeltaX){let t=Math.round(e.wheelDeltaX*PerfUI.OverviewGrid.WindowScrollSpeedFactor);const i=this._leftResizeElement.offsetLeft+PerfUI.OverviewGrid.ResizerOffset;const s=this._rightResizeElement.offsetLeft+PerfUI.OverviewGrid.ResizerOffset;if(i-t<0)t=i;if(s-t>this._parentElement.clientWidth)t=s-this._parentElement.clientWidth;this._setWindowPosition(i-t,s-t);e.preventDefault()}}_zoom(e,t){let i=this.windowLeft;let s=this.windowRight;const n=s-i;let r=e*n;if(r>1){r=1;e=r/n}i=t+(i-t)*e;i=Number.constrain(i,0,1-r);s=t+(s-t)*e;s=Number.constrain(s,r,1);this._setWindow(i,s)}};PerfUI.OverviewGrid.Events={WindowChanged:Symbol("WindowChanged")};PerfUI.OverviewGrid.WindowSelector=class{constructor(e,t){this._startPosition=t;this._width=e.offsetWidth;this._windowSelector=createElement("div");this._windowSelector.className="overview-grid-window-selector";this._windowSelector.style.left=this._startPosition+"px";this._windowSelector.style.right=this._width-this._startPosition+"px";e.appendChild(this._windowSelector)}_close(e){e=Math.max(0,Math.min(e,this._width));this._windowSelector.remove();return this._startPosition<e?{start:this._startPosition,end:e}:{start:e,end:this._startPosition}}_updatePosition(e){e=Math.max(0,Math.min(e,this._width));if(e<this._startPosition){this._windowSelector.style.left=e+"px";this._windowSelector.style.right=this._width-this._startPosition+"px"}else{this._windowSelector.style.left=this._startPosition+"px";this._windowSelector.style.right=this._width-e+"px"}}};PerfUI.PieChartOptions;PerfUI.PieChart=class{constructor(e){const{size:t,formatter:i,showLegend:s,chartName:n}=e;this.element=createElement("div");this._shadowRoot=UI.createShadowRootWithCoreStyles(this.element,"perf_ui/pieChart.css");const r=this._shadowRoot.createChild("div","root");UI.ARIAUtils.markAsGroup(r);UI.ARIAUtils.setAccessibleName(r,n);this._chartRoot=r.createChild("div","chart-root");const o=this._createSVGChild(this._chartRoot,"svg");this._group=this._createSVGChild(o,"g");this._innerR=.618;const a=1/t;let l=this._createSVGChild(this._group,"circle");l.setAttribute("r",1);l.setAttribute("stroke","hsl(0, 0%, 80%)");l.setAttribute("fill","transparent");l.setAttribute("stroke-width",a);l=this._createSVGChild(this._group,"circle");l.setAttribute("r",this._innerR);l.setAttribute("stroke","hsl(0, 0%, 80%)");l.setAttribute("fill","transparent");l.setAttribute("stroke-width",a);this._foregroundElement=this._chartRoot.createChild("div","pie-chart-foreground");this._totalElement=this._foregroundElement.createChild("div","pie-chart-total");this._formatter=i;this._slices=[];this._lastAngle=-Math.PI/2;if(s)this._legend=r.createChild("div","pie-chart-legend");this._setSize(t)}setTotal(e){for(let e=0;e<this._slices.length;++e)this._slices[e].remove();this._slices=[];this._totalValue=e;this._lastAngle=-Math.PI/2;let t;if(e)t=this._formatter?this._formatter(e):e;else t="";this._totalElement.textContent=t;if(this._legend){this._legend.removeChildren();const t=this._addLegendItem(e,ls`Total`);UI.ARIAUtils.setLabelledBy(this._totalElement,[t])}}_setSize(e){this._group.setAttribute("transform","scale("+e/2+") translate(1, 1) scale(0.99, 0.99)");const t=e+"px";this._chartRoot.style.width=t;this._chartRoot.style.height=t}addSlice(e,t,i){let s=e/this._totalValue*2*Math.PI;if(!isFinite(s))return;s=Math.min(s,2*Math.PI*.9999);const n=this._createSVGChild(this._group,"path");const r=Math.cos(this._lastAngle);const o=Math.sin(this._lastAngle);this._lastAngle+=s;const a=Math.cos(this._lastAngle);const l=Math.sin(this._lastAngle);const h=this._innerR;const d=a*h;const c=l*h;const _=r*h;const u=o*h;const f=s>Math.PI?1:0;n.setAttribute("d",`M${r},${o} A1,1,0,${f},1,${a},${l} L${d},${c} A${h},${h},0,${f},0,${_},${u} Z`);n.setAttribute("fill",t);this._slices.push(n);if(this._legend){const s=this._addLegendItem(e,i,t);UI.ARIAUtils.setLabelledBy(n,[s])}}_createSVGChild(e,t){const i=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg",t);e.appendChild(i);return i}_addLegendItem(e,t,i){const s=this._legend.ownerDocument.createElement("div");s.className="pie-chart-legend-row";if(this._legend.childElementCount)this._legend.insertBefore(s,this._legend.lastElementChild);else this._legend.appendChild(s);const n=s.createChild("div","pie-chart-size");const r=s.createChild("div","pie-chart-swatch");const o=s.createChild("div","pie-chart-name");if(i)r.style.backgroundColor=i;else r.classList.add("pie-chart-empty-swatch");o.textContent=t;n.textContent=this._formatter?this._formatter(e):e;return s}};PerfUI.TimelineGrid=class{constructor(){this.element=createElement("div");UI.appendStyle(this.element,"perf_ui/timelineGrid.css");this._dividersElement=this.element.createChild("div","resources-dividers");this._gridHeaderElement=createElement("div");this._gridHeaderElement.classList.add("timeline-grid-header");this._eventDividersElement=this._gridHeaderElement.createChild("div","resources-event-dividers");this._dividersLabelBarElement=this._gridHeaderElement.createChild("div","resources-dividers-label-bar");this.element.appendChild(this._gridHeaderElement)}static calculateGridOffsets(e,t){const i=64;const s=e.computePosition(e.maximumBoundary());let n=s/i;let r=e.boundarySpan()/n;const o=s/e.boundarySpan();const a=Math.ceil(Math.log(r)/Math.LN10);r=Math.pow(10,a);if(r*o>=5*i)r=r/5;if(r*o>=2*i)r=r/2;const l=Math.ceil((e.minimumBoundary()-e.zeroTime())/r)*r+e.zeroTime();let h=e.maximumBoundary();h+=i/o;n=Math.ceil((h-l)/r);if(!r)n=0;const d=[];for(let i=0;i<n;++i){const s=l+r*i;if(e.computePosition(s)<t)continue;d.push({position:Math.floor(e.computePosition(s)),time:s})}return{offsets:d,precision:Math.max(0,-Math.floor(Math.log(r*1.01)/Math.LN10))}}static drawCanvasGrid(e,t){e.save();e.scale(window.devicePixelRatio,window.devicePixelRatio);const i=Math.floor(e.canvas.height/window.devicePixelRatio);e.strokeStyle=UI.themeSupport.patchColorText("rgba(0, 0, 0, 0.1)",UI.ThemeSupport.ColorUsage.Foreground);e.lineWidth=1;e.translate(.5,.5);e.beginPath();for(const s of t.offsets){e.moveTo(s.position,0);e.lineTo(s.position,i)}e.stroke();e.restore()}static drawCanvasHeaders(e,t,i,s,n,r){e.save();e.scale(window.devicePixelRatio,window.devicePixelRatio);const o=Math.ceil(e.canvas.width/window.devicePixelRatio);e.beginPath();e.fillStyle=UI.themeSupport.patchColorText("rgba(255, 255, 255, 0.5)",UI.ThemeSupport.ColorUsage.Background);e.fillRect(0,0,o,n);e.fillStyle=UI.themeSupport.patchColorText("#333",UI.ThemeSupport.ColorUsage.Foreground);e.textBaseline="hanging";e.font="11px "+Host.fontFamily();const a=4;for(const n of t.offsets){const t=i(n.time);const o=e.measureText(t).width;const l=n.position-o-a;if(!r||r<l)e.fillText(t,l,s)}e.restore()}get dividersElement(){return this._dividersElement}get dividersLabelBarElement(){return this._dividersLabelBarElement}removeDividers(){this._dividersElement.removeChildren();this._dividersLabelBarElement.removeChildren()}updateDividers(e,t){const i=PerfUI.TimelineGrid.calculateGridOffsets(e,t);const s=i.offsets;const n=i.precision;const r=this._dividersElement.clientWidth;let o=this._dividersElement.firstChild;let a=this._dividersLabelBarElement.firstChild;for(let t=0;t<s.length;++t){if(!o){o=createElement("div");o.className="resources-divider";this._dividersElement.appendChild(o);a=createElement("div");a.className="resources-divider";const e=createElement("div");e.className="resources-divider-label";a._labelElement=e;a.appendChild(e);this._dividersLabelBarElement.appendChild(a)}const i=s[t].time;const l=s[t].position;a._labelElement.textContent=e.formatValue(i,n);const h=100*l/r;o.style.left=h+"%";a.style.left=h+"%";o=o.nextSibling;a=a.nextSibling}while(o){const e=o.nextSibling;this._dividersElement.removeChild(o);o=e}while(a){const e=a.nextSibling;this._dividersLabelBarElement.removeChild(a);a=e}return true}addEventDivider(e){this._eventDividersElement.appendChild(e)}addEventDividers(e){this._gridHeaderElement.removeChild(this._eventDividersElement);for(const t of e)this._eventDividersElement.appendChild(t);this._gridHeaderElement.appendChild(this._eventDividersElement)}removeEventDividers(){this._eventDividersElement.removeChildren()}hideEventDividers(){this._eventDividersElement.classList.add("hidden")}showEventDividers(){this._eventDividersElement.classList.remove("hidden")}hideDividers(){this._dividersElement.classList.add("hidden")}showDividers(){this._dividersElement.classList.remove("hidden")}setScrollTop(e){this._dividersLabelBarElement.style.top=e+"px";this._eventDividersElement.style.top=e+"px"}};PerfUI.TimelineGrid.DividersData;PerfUI.TimelineGrid.Calculator=function(){};PerfUI.TimelineGrid.Calculator.prototype={computePosition(e){},formatValue(e,t){},minimumBoundary(){},zeroTime(){},maximumBoundary(){},boundarySpan(){}};PerfUI.TimelineOverviewPane=class extends UI.VBox{constructor(e){super();this.element.id=e+"-overview-pane";this._overviewCalculator=new PerfUI.TimelineOverviewCalculator;this._overviewGrid=new PerfUI.OverviewGrid(e);this.element.appendChild(this._overviewGrid.element);this._cursorArea=this._overviewGrid.element.createChild("div","overview-grid-cursor-area");this._cursorElement=this._overviewGrid.element.createChild("div","overview-grid-cursor-position");this._cursorArea.addEventListener("mousemove",this._onMouseMove.bind(this),true);this._cursorArea.addEventListener("mouseleave",this._hideCursor.bind(this),true);this._overviewGrid.setResizeEnabled(false);this._overviewGrid.addEventListener(PerfUI.OverviewGrid.Events.WindowChanged,this._onWindowChanged,this);this._overviewGrid.setClickHandler(this._onClick.bind(this));this._overviewControls=[];this._markers=new Map;this._overviewInfo=new PerfUI.TimelineOverviewPane.OverviewInfo(this._cursorElement);this._updateThrottler=new Common.Throttler(100);this._cursorEnabled=false;this._cursorPosition=0;this._lastWidth=0}_onMouseMove(e){if(!this._cursorEnabled)return;this._cursorPosition=e.offsetX+e.target.offsetLeft;this._cursorElement.style.left=this._cursorPosition+"px";this._cursorElement.style.visibility="visible";this._overviewInfo.setContent(this._buildOverviewInfo())}async _buildOverviewInfo(){const e=this.element.ownerDocument;const t=this._cursorPosition;const i=await Promise.all(this._overviewControls.map(e=>e.overviewInfoPromise(t)));const s=e.createDocumentFragment();i.remove(null);s.appendChildren.apply(s,i);return s}_hideCursor(){this._cursorElement.style.visibility="hidden";this._overviewInfo.hide()}wasShown(){this._update()}willHide(){this._overviewInfo.hide()}onResize(){const e=this.element.offsetWidth;if(e===this._lastWidth)return;this._lastWidth=e;this.scheduleUpdate()}setOverviewControls(e){for(let e=0;e<this._overviewControls.length;++e)this._overviewControls[e].dispose();for(let t=0;t<e.length;++t){e[t].setCalculator(this._overviewCalculator);e[t].show(this._overviewGrid.element)}this._overviewControls=e;this._update()}setBounds(e,t){this._overviewCalculator.setBounds(e,t);this._overviewGrid.setResizeEnabled(true);this._cursorEnabled=true}scheduleUpdate(){this._updateThrottler.schedule(e.bind(this));function e(){this._update();return Promise.resolve()}}_update(){if(!this.isShowing())return;this._overviewCalculator.setDisplayWidth(this._overviewGrid.clientWidth());for(let e=0;e<this._overviewControls.length;++e)this._overviewControls[e].update();this._overviewGrid.updateDividers(this._overviewCalculator);this._updateMarkers();this._updateWindow()}setMarkers(e){this._markers=e}_updateMarkers(){const e=new Map;for(const t of this._markers.keys()){const i=this._markers.get(t);const s=Math.round(this._overviewCalculator.computePosition(t));if(e.has(s))continue;e.set(s,i);i.style.left=s+"px"}this._overviewGrid.removeEventDividers();this._overviewGrid.addEventDividers(e.valuesArray())}reset(){this._windowStartTime=0;this._windowEndTime=Infinity;this._overviewCalculator.reset();this._overviewGrid.reset();this._overviewGrid.setResizeEnabled(false);this._cursorEnabled=false;this._hideCursor();this._markers=new Map;for(const e of this._overviewControls)e.reset();this._overviewInfo.hide();this.scheduleUpdate()}_onClick(e){return this._overviewControls.some(t=>t.onClick(e))}_onWindowChanged(e){if(this._muteOnWindowChanged)return;if(!this._overviewControls.length)return;const t=this._overviewCalculator.minimumBoundary();const i=this._overviewCalculator.maximumBoundary()-t;const s={startTime:t+i*this._overviewGrid.windowLeft(),endTime:t+i*this._overviewGrid.windowRight()};this._windowStartTime=s.startTime;this._windowEndTime=s.endTime;this.dispatchEventToListeners(PerfUI.TimelineOverviewPane.Events.WindowChanged,s)}setWindowTimes(e,t){if(e===this._windowStartTime&&t===this._windowEndTime)return;this._windowStartTime=e;this._windowEndTime=t;this._updateWindow();this.dispatchEventToListeners(PerfUI.TimelineOverviewPane.Events.WindowChanged,{startTime:e,endTime:t})}_updateWindow(){if(!this._overviewControls.length)return;const e=this._overviewCalculator.minimumBoundary();const t=this._overviewCalculator.maximumBoundary()-e;const i=e>0;const s=i&&this._windowStartTime?Math.min((this._windowStartTime-e)/t,1):0;const n=i&&this._windowEndTime<Infinity?(this._windowEndTime-e)/t:1;this._muteOnWindowChanged=true;this._overviewGrid.setWindow(s,n);this._muteOnWindowChanged=false}};PerfUI.TimelineOverviewPane.Events={WindowChanged:Symbol("WindowChanged")};PerfUI.TimelineOverviewCalculator=class{constructor(){this.reset()}computePosition(e){return(e-this._minimumBoundary)/this.boundarySpan()*this._workingArea}positionToTime(e){return e/this._workingArea*this.boundarySpan()+this._minimumBoundary}setBounds(e,t){this._minimumBoundary=e;this._maximumBoundary=t}setDisplayWidth(e){this._workingArea=e}reset(){this.setBounds(0,100)}formatValue(e,t){return Number.preciseMillisToString(e-this.zeroTime(),t)}maximumBoundary(){return this._maximumBoundary}minimumBoundary(){return this._minimumBoundary}zeroTime(){return this._minimumBoundary}boundarySpan(){return this._maximumBoundary-this._minimumBoundary}};PerfUI.TimelineOverview=function(){};PerfUI.TimelineOverview.prototype={show(e,t){},update(){},dispose(){},reset(){},overviewInfoPromise(e){},onClick(e){}};PerfUI.TimelineOverviewBase=class extends UI.VBox{constructor(){super();this._calculator=null;this._canvas=this.element.createChild("canvas","fill");this._context=this._canvas.getContext("2d")}width(){return this._canvas.width}height(){return this._canvas.height}context(){return this._context}calculator(){return this._calculator}update(){this.resetCanvas()}dispose(){this.detach()}reset(){}overviewInfoPromise(e){return Promise.resolve(null)}setCalculator(e){this._calculator=e}onClick(e){return false}resetCanvas(){if(this.element.clientWidth)this.setCanvasSize(this.element.clientWidth,this.element.clientHeight)}setCanvasSize(e,t){this._canvas.width=e*window.devicePixelRatio;this._canvas.height=t*window.devicePixelRatio}};PerfUI.TimelineOverviewPane.OverviewInfo=class{constructor(e){this._anchorElement=e;this._glassPane=new UI.GlassPane;this._glassPane.setPointerEventsBehavior(UI.GlassPane.PointerEventsBehavior.PierceContents);this._glassPane.setMarginBehavior(UI.GlassPane.MarginBehavior.Arrow);this._glassPane.setSizeBehavior(UI.GlassPane.SizeBehavior.MeasureContent);this._visible=false;this._element=UI.createShadowRootWithCoreStyles(this._glassPane.contentElement,"perf_ui/timelineOverviewInfo.css").createChild("div","overview-info")}async setContent(e){this._visible=true;const t=await e;if(!this._visible)return;this._element.removeChildren();this._element.appendChild(t);this._glassPane.setContentAnchorBox(this._anchorElement.boxInWindow());if(!this._glassPane.isShowing())this._glassPane.show(this._anchorElement.ownerDocument)}hide(){this._visible=false;this._glassPane.hide()}};Runtime.cachedResources["perf_ui/chartViewport.css"]="/*\n * Copyright 2017 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.chart-viewport-v-scroll {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    overflow-x: hidden;\n    z-index: 200;\n    padding-left: 1px;\n}\n\n.chart-viewport-v-scroll.always-show-scrollbar {\n    overflow-y: scroll;\n}\n\n/* force non overlay scrollbars for Mac */\n:host-context(.platform-mac) .chart-viewport-v-scroll {\n    right: 2px;\n    top: 3px;\n    bottom: 3px;\n}\n\n:host-context(.platform-mac) ::-webkit-scrollbar {\n    width: 8px;\n}\n\n:host-context(.platform-mac) ::-webkit-scrollbar-thumb {\n    background-color: hsla(0, 0%, 56%, 0.6);\n    border-radius: 50px;\n}\n\n:host-context(.platform-mac) .chart-viewport-v-scroll:hover::-webkit-scrollbar-thumb {\n    background-color: hsla(0, 0%, 25%, 0.6);\n}\n\n/* force non overlay scrollbars for Aura Overlay Scrollbar enabled */\n:host-context(.overlay-scrollbar-enabled) ::-webkit-scrollbar {\n    width: 10px;\n}\n\n:host-context(.overlay-scrollbar-enabled) ::-webkit-scrollbar-thumb {\n    background-color: hsla(0, 0%, 0%, 0.5);\n}\n\n:host-context(.overlay-scrollbar-enabled) .chart-viewport-v-scroll:hover::-webkit-scrollbar-thumb {\n    background-color: hsla(0, 0%, 0%, 0.7);\n}\n\n.chart-viewport-selection-overlay {\n    position: absolute;\n    z-index: 100;\n    background-color: rgba(56, 121, 217, 0.3);\n    border-color: rgb(16, 81, 177);\n    border-width: 0 1px;\n    border-style: solid;\n    pointer-events: none;\n    top: 0;\n    bottom: 0;\n    text-align: center;\n}\n\n.chart-viewport-selection-overlay .time-span {\n    white-space: nowrap;\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n";Runtime.cachedResources["perf_ui/filmStripView.css"]="/*\n * Copyright (c) 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.film-strip-view {\n    overflow-x: auto;\n    overflow-y: hidden;\n    align-content: flex-start;\n    min-height: 81px;\n}\n\n.film-strip-view.time-based .frame .time {\n    display: none;\n}\n\n.film-strip-view .label {\n    margin: auto;\n    font-size: 18px;\n    color: #999;\n}\n\n.film-strip-view .frame {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 4px;\n    flex: none;\n    cursor: pointer;\n}\n\n.film-strip-view .frame .thumbnail {\n    min-width: 24px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    pointer-events: none;\n    margin: 4px 0 2px;\n    border: 2px solid transparent;\n}\n\n.film-strip-view .frame:hover .thumbnail {\n    border-color: #FBCA46;\n}\n\n.film-strip-view .frame .thumbnail img {\n    height: auto;\n    width: auto;\n    max-width: 80px;\n    max-height: 50px;\n    pointer-events: none;\n    box-shadow: 0 0 3px #bbb;\n    flex: 0 0 auto;\n}\n\n.film-strip-view .frame:hover .thumbnail img {\n    box-shadow: none;\n}\n\n.film-strip-view .frame .time {\n    font-size: 10px;\n    margin-top: 2px;\n}\n";Runtime.cachedResources["perf_ui/flameChart.css"]='/*\n * Copyright 2017 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.flame-chart-main-pane {\n    overflow: hidden;\n}\n\n.flame-chart-marker-highlight-element {\n    position: absolute;\n    top: 1px;\n    height: 18px;\n    width: 6px;\n    margin: 0 -3px;\n    content: "";\n    display: block;\n}\n\n.flame-chart-canvas[data-keyboard-focus="true"]:focus {\n    border-top: 1px solid var(--accent-color);\n    border-bottom: 1px solid var(--accent-color);\n}\n\n.flame-chart-highlight-element {\n    position: absolute;\n    pointer-events: none;\n    background-color: rgba(56, 121, 217, 0.1);\n}\n\n.flame-chart-selected-element {\n    position: absolute;\n    pointer-events: none;\n    outline: 2px solid var(--selection-bg-color);\n    background-color: rgba(56, 121, 217, 0.1);\n}\n\n.chart-cursor-element {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    z-index: 100;\n    width: 2px;\n    background-color: var(--selection-bg-color);\n    pointer-events: none;\n}\n\n.flame-chart-entry-info:not(:empty) {\n    z-index: 2000;\n    position: absolute;\n    background-color: white;\n    pointer-events: none;\n    padding: 4px 8px;\n    white-space: nowrap;\n    max-width: 80%;\n    box-shadow: var(--drop-shadow);\n}\n\n.flame-chart-entry-info table tr td:empty {\n    padding: 0;\n}\n\n.flame-chart-entry-info table tr td:not(:empty) {\n    padding: 0 5px;\n    white-space: nowrap;\n}\n\n.flame-chart-entry-info table tr td:first-child {\n    font-weight: bold;\n}\n\n.flame-chart-entry-info table tr td span {\n    margin-right: 5px;\n}\n';Runtime.cachedResources["perf_ui/overviewGrid.css"]="/*\n * Copyright (c) 2014 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.overview-grid-window-selector {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    background-color: rgba(125, 173, 217, 0.5);\n    z-index: 250;\n    pointer-events: none;\n}\n\n.overview-grid-window-resizer {\n    position: absolute;\n    top: -1px;\n    height: 20px;\n    width: 6px;\n    margin-left: -3px;\n    background-color: rgb(153, 153, 153);\n    border: 1px solid white;\n    z-index: 500;\n}\n\n.overview-grid-cursor-area {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 20px;\n    bottom: 0;\n    z-index: 500;\n    cursor: text;\n}\n\n.overview-grid-cursor-position {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    width: 2px;\n    background-color: hsla(220, 95%, 50%, 0.7);\n    z-index: 500;\n    pointer-events: none;\n    visibility: hidden;\n    overflow: hidden;\n}\n\n.window-curtain-left, .window-curtain-right {\n    background-color: hsla(0, 0%, 80%, 0.5);\n    position: absolute;\n    top: 0;\n    height: 100%;\n    z-index: 300;\n    pointer-events: none;\n    border: 1px none hsla(0, 0%, 70%, 0.5);\n}\n\n.window-curtain-left {\n    left: 0;\n    border-right-style: solid;\n}\n\n.window-curtain-right {\n    right: 0;\n    border-left-style: solid;\n}\n";Runtime.cachedResources["perf_ui/pieChart.css"]="/*\n * Copyright (c) 2014 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.root {\n    align-items: center;\n    display: flex;\n    min-width: fit-content;\n    white-space: nowrap;\n}\n\n.chart-root {\n    position: relative;\n    overflow: hidden;\n}\n\n.pie-chart-foreground {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    z-index: 10;\n    top: 0;\n    display: flex;\n    pointer-events: none;\n}\n\n.pie-chart-total {\n    margin: auto;\n    padding: 2px 5px;\n    background-color: rgba(255, 255, 255, 0.6);\n    pointer-events: auto;\n}\n\n.pie-chart-legend {\n    margin-left: 30px;\n}\n\n.pie-chart-legend-row {\n    margin: 5px auto;\n    padding-right: 25px;\n}\n\n.pie-chart-swatch {\n    display: inline-block;\n    width: 11px;\n    height: 11px;\n    margin: 0 6px;\n    top: 1px;\n    position: relative;\n    border: 1px solid rgba(100, 100, 100, 0.2);\n}\n\n.pie-chart-swatch.pie-chart-empty-swatch {\n    border: none;\n}\n\n.pie-chart-name {\n    display: inline-block;\n}\n\n.pie-chart-size {\n    display: inline-block;\n    text-align: right;\n    width: 70px;\n}\n";Runtime.cachedResources["perf_ui/timelineGrid.css"]="/*\n * Copyright (c) 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.resources-dividers {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    z-index: -100;\n    bottom: 0;\n}\n\n.resources-event-dividers {\n    position: absolute;\n    left: 0;\n    right: 0;\n    height: 100%;\n    top: 0;\n    z-index: 300;\n    pointer-events: none;\n}\n\n.resources-dividers-label-bar {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    background-color: rgba(255, 255, 255, 0.85);\n    background-clip: padding-box;\n    height: 20px;\n    z-index: 200;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.resources-divider {\n    position: absolute;\n    width: 1px;\n    top: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.1);\n}\n\n.resources-event-divider {\n    position: absolute;\n    width: 1px;\n    top: 0;\n    bottom: 0;\n    z-index: 300;\n}\n\n.resources-divider-label {\n    position: absolute;\n    top: 4px;\n    right: 3px;\n    font-size: 80%;\n    white-space: nowrap;\n    pointer-events: none;\n}\n\n.timeline-grid-header {\n    height: 20px;\n    pointer-events: none;\n}\n";Runtime.cachedResources["perf_ui/timelineOverviewInfo.css"]="/*\n * Copyright 2017 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.overview-info:not(:empty) {\n    display: flex;\n    background: white;\n    box-shadow: var(--drop-shadow);\n    padding: 3px;\n}\n\n.overview-info .frame .time {\n    display: none;\n}\n\n.overview-info .frame .thumbnail img {\n    max-width: 50vw;\n    max-height: 50vh;\n}\n";